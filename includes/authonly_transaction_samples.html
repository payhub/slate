<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_authonly_transaction_samples">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.jpg" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <pre><code class="highlight java">
    <span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>

    <span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthOnly</span> <span class="o">{</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">RunAuthOnly</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
          <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
          <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
          <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

          <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://payhub.com/payhubws/api/v2/authOnly"</span><span class="o">;</span>

          <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
            <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span><span class="c1">//You put your org id here</span>
            <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>
          <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>

          <span class="n">JSONObject</span> <span class="n">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
            <span class="n">JSONObject</span> <span class="n">base_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
              <span class="n">base_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"1275"</span><span class="o">);</span><span class="c1">//$12.75</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"base_amount"</span><span class="o">,</span> <span class="n">base_amount</span><span class="o">);</span>
            <span class="n">JSONObject</span> <span class="n">shipping_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
              <span class="n">shipping_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"725"</span><span class="o">);</span><span class="c1">//$7.25</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"shipping_amount"</span><span class="o">,</span> <span class="n">shipping_amount</span><span class="o">);</span>
            <span class="n">JSONObject</span> <span class="n">tax_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
              <span class="n">tax_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"113"</span><span class="o">);</span><span class="c1">//$1.13</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"tax_amount"</span><span class="o">,</span> <span class="n">tax_amount</span><span class="o">);</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"note"</span><span class="o">,</span> <span class="s">"Shipped as a gift"</span><span class="o">);</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"invoice_number"</span><span class="o">,</span> <span class="s">"4645782"</span><span class="o">);</span>
            <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"po_number"</span><span class="o">,</span> <span class="s">"1234-654321"</span><span class="o">);</span>
          <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"bill"</span><span class="o">,</span> <span class="n">bill</span><span class="o">);</span>

          <span class="n">JSONObject</span> <span class="n">card_data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_number"</span><span class="o">,</span> <span class="s">"5466410004374507"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_expiry_date"</span><span class="o">,</span> <span class="s">"201809"</span><span class="o">);</span><span class="c1">// September 2018</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_1"</span><span class="o">,</span> <span class="s">"237 E 33rd Street"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_2"</span><span class="o">,</span> <span class="s">"3rd Floor"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_city"</span><span class="o">,</span> <span class="s">"New York"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_zip"</span><span class="o">,</span> <span class="s">"10016"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_state"</span><span class="o">,</span> <span class="s">"NY"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cvv_data"</span><span class="o">,</span> <span class="s">"998"</span><span class="o">);</span>
            <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cvv_code"</span><span class="o">,</span> <span class="s">"Y"</span><span class="o">);</span>
          <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_data"</span><span class="o">,</span> <span class="n">card_data</span><span class="o">);</span>

          <span class="n">JSONObject</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"first_name"</span><span class="o">,</span> <span class="s">"John"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"last_name"</span><span class="o">,</span> <span class="s">"Smith"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"company_name"</span><span class="o">,</span> <span class="s">"CBA Steakhouse"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"job_title"</span><span class="o">,</span> <span class="s">"Owner"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email_address"</span><span class="o">,</span> <span class="s">"john@cbasteakhouse.com"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"web_address"</span><span class="o">,</span> <span class="s">"http://www.cbasteakhouse.com"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_number"</span><span class="o">,</span> <span class="s">"(917) 479 1349"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_ext"</span><span class="o">,</span> <span class="s">"5478"</span><span class="o">);</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_type"</span><span class="o">,</span> <span class="s">"M"</span><span class="o">);</span>
          <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="n">customer</span><span class="o">);</span>

          <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"record_format"</span><span class="o">,</span> <span class="s">"CC"</span><span class="o">);</span>

          <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
          <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
          <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
          <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

          <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
          <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
          <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span> <span class="c1">//You return this response and work with it</span>

          <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
          <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

          <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
          <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
          <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
          <span class="o">}</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
                <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                    <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                    <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
          <span class="o">}</span>
          <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
            <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
              <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
                <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
                <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
                <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
                <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Transaction Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span> <span class="c1">//Last resource of the path</span>
              <span class="o">}</span>

            <span class="o">}</span>
          <span class="o">}</span>
          <span class="k">else</span><span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
          <span class="o">}</span>


        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
      <span class="o">}</span>

    <span class="o">}</span>
</code></pre>
<pre><code class="highlight php">
    <span class="cp">&lt;?php</span>
      <span class="nv">$trans_type</span> <span class="o">=</span> <span class="s2">"authOnly"</span><span class="p">;</span>
      <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
      <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

      <span class="c1">//Defining the Web Service URL
</span>      <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"http://payhub.com/payhubws/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


      <span class="c1">//Defining data for the AuthOnly transaction
</span>      <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>      <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
      <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>
      <span class="c1">// bill data
</span>      <span class="nv">$base_amount</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
      <span class="nv">$shipping_amount</span> <span class="o">=</span> <span class="mf">1.23</span><span class="p">;</span>
      <span class="nv">$tax_amount</span> <span class="o">=</span> <span class="mf">1.00</span><span class="p">;</span>
      <span class="nv">$note</span> <span class="o">=</span> <span class="s2">"this a sample note"</span><span class="p">;</span>
      <span class="nv">$invoice_number</span> <span class="o">=</span> <span class="s2">"a-00240"</span><span class="p">;</span>
      <span class="nv">$po_number</span> <span class="o">=</span> <span class="s2">"56"</span><span class="p">;</span>
      <span class="c1">//Credit card data
</span>      <span class="nv">$card_number</span> <span class="o">=</span> <span class="s2">"5466410004374507"</span><span class="p">;</span>
      <span class="nv">$card_expiry_date</span> <span class="o">=</span> <span class="s2">"202011"</span><span class="p">;</span>
      <span class="nv">$cvv_data</span> <span class="o">=</span> <span class="s2">"998"</span><span class="p">;</span>
      <span class="nv">$billing_address_1</span> <span class="o">=</span> <span class="s2">"2350 Kerner Blvd"</span><span class="p">;</span>
      <span class="nv">$billing_address_2</span> <span class="o">=</span> <span class="s2">"On the corner"</span><span class="p">;</span>
      <span class="nv">$billing_city</span> <span class="o">=</span> <span class="s2">"San Rafael"</span><span class="p">;</span>
      <span class="nv">$billing_state</span> <span class="o">=</span> <span class="s2">"CA"</span><span class="p">;</span>
      <span class="nv">$billing_zip</span> <span class="o">=</span> <span class="s2">"94901"</span><span class="p">;</span>
      <span class="c1">// Customer data
</span>      <span class="nv">$first_name</span> <span class="o">=</span> <span class="s2">"First"</span><span class="p">;</span>
      <span class="nv">$last_name</span> <span class="o">=</span> <span class="s2">"Contact"</span><span class="p">;</span>
      <span class="nv">$company_name</span> <span class="o">=</span> <span class="s2">"Payhub Inc"</span><span class="p">;</span>
      <span class="nv">$job_title</span> <span class="o">=</span> <span class="s2">"Software Engineer"</span><span class="p">;</span>
      <span class="nv">$email_address</span> <span class="o">=</span> <span class="s2">"jhon@company.com"</span><span class="p">;</span>
      <span class="nv">$web_address</span> <span class="o">=</span> <span class="s2">"http://payhub.com"</span><span class="p">;</span>
      <span class="nv">$phone_number</span> <span class="o">=</span> <span class="s2">"(415) 479 1349"</span><span class="p">;</span>
      <span class="nv">$phone_ext</span> <span class="o">=</span> <span class="s2">"123"</span><span class="p">;</span>
      <span class="nv">$phone_type</span> <span class="o">=</span> <span class="s2">"M"</span><span class="p">;</span>


      <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>      <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"bill"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"base_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$base_amount</span><span class="p">),</span>
        <span class="s2">"shipping_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$shipping_amount</span><span class="p">),</span>
        <span class="s2">"tax_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$tax_amount</span><span class="p">));</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"card_data"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"card_expiry_date"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_expiry_date</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"cvv_data"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$cvv_data</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_address_1"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_1</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"billing_address_2"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_2</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_city"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_city</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"billing_state"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_state</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_zip"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_zip</span><span class="s2">"</span><span class="p">);</span>
      <span class="nv">$data</span> <span class="p">[</span><span class="s2">"customer"</span><span class="p">]</span><span class="o">=</span>  <span class="k">array</span><span class="p">(</span><span class="s2">"first_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$first_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$last_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"company_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$company_name</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"job_title"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$job_title</span><span class="s2">"</span><span class="p">,</span><span class="s2">"email_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$email_address</span><span class="s2">"</span><span class="p">,</span><span class="s2">"web_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$web_address</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_ext"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_ext</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_type"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_type</span><span class="s2">"</span><span class="p">);</span>

      <span class="c1">//Convert data from Array to JSON
</span>      <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

      <span class="c1">//Creating a CURL object to access the WS
</span>      <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
      <span class="c1">//Setting the address to connect to
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
      <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
      <span class="c1">//Setting data in JSON format
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
      <span class="c1">//Setting the proper header.
</span>      <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
        <span class="s1">'Accept: application/json'</span><span class="p">,</span>
        <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
        <span class="p">);</span>
      <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

      <span class="c1">//execute connection to the Web Service
</span>      <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
      <span class="c1">// get some data from the response
</span>      <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
      <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
      <span class="c1">//Get the header as string.
</span>      <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
      <span class="c1">//close connection to the Web Service
</span>      <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

      <span class="c1">//Obtain the data from the sale recently created
</span>      <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
        <span class="c1">//find the url of the sale (Location header in the response)
</span>        <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
        <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>        <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>        <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
        <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
        <span class="c1">//Setting the proper header.
</span>        <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
        <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="c1">//execute connection to the Web Service
</span>        <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="c1">//close connection to the Web Service
</span>        <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>        <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
        <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>        <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="c1">//There was an error with the WS
</span>      <span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="cp">?&gt;</span>
</code></pre>
<pre><code class="highlight csharp">
    <span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>

    <span class="k">namespace</span> <span class="nn">PayHubSamples</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">class</span> <span class="nc">AuthOnly</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunAuthOnly</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://payhub.com/payhubws/api/v2/authonly"</span><span class="p">);</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                    <span class="n">var</span> <span class="n">authOnly</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                         <span class="p">{</span>
                             <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                             <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                         <span class="p">},</span>
                        <span class="n">bill</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">base_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"1275"</span> <span class="c1">//$12.75
</span>                            <span class="p">},</span>
                            <span class="n">shipping_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"725"</span> <span class="c1">//$7.25
</span>                            <span class="p">},</span>
                            <span class="n">tax_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"113"</span> <span class="c1">//$1.13
</span>                            <span class="p">},</span>
                            <span class="n">note</span> <span class="p">=</span> <span class="s">"Shipped as a gift"</span><span class="p">,</span>
                            <span class="n">invoice_number</span> <span class="p">=</span> <span class="s">"4645782"</span><span class="p">,</span>
                            <span class="n">po_number</span> <span class="p">=</span> <span class="s">"1234-654321"</span>
                        <span class="p">},</span>
                        <span class="n">card_data</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">card_number</span> <span class="p">=</span> <span class="s">"5466410004374507"</span><span class="p">,</span>
                            <span class="n">card_expiry_date</span> <span class="p">=</span> <span class="s">"201809"</span><span class="p">,</span> <span class="c1">//September 2018
</span>                            <span class="n">billing_address_1</span> <span class="p">=</span> <span class="s">"237 E 33rd Street"</span><span class="p">,</span>
                            <span class="n">billing_address_2</span> <span class="p">=</span> <span class="s">"3rd Floor"</span><span class="p">,</span>
                            <span class="n">billing_city</span> <span class="p">=</span> <span class="s">"New York"</span><span class="p">,</span>
                            <span class="n">billing_state</span> <span class="p">=</span> <span class="s">"NY"</span><span class="p">,</span>
                            <span class="n">billing_zip</span> <span class="p">=</span> <span class="s">"10016"</span><span class="p">,</span>
                            <span class="n">cvv_data</span> <span class="p">=</span> <span class="s">"998"</span><span class="p">,</span>
                            <span class="n">cvv_code</span> <span class="p">=</span> <span class="s">"Y"</span>
                        <span class="p">},</span>
                        <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">first_name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span>
                            <span class="n">last_name</span> <span class="p">=</span> <span class="s">"Smith"</span><span class="p">,</span>
                            <span class="n">company_name</span> <span class="p">=</span> <span class="s">"CBA Stakehouse"</span><span class="p">,</span>
                            <span class="n">job_title</span> <span class="p">=</span> <span class="s">"Owner"</span><span class="p">,</span>
                            <span class="n">email_address</span> <span class="p">=</span> <span class="s">"john@cbastakehouse.com"</span><span class="p">,</span>
                            <span class="n">web_address</span> <span class="p">=</span> <span class="s">"http://www.cbasteakhouse.com"</span><span class="p">,</span>
                            <span class="n">phone_number</span> <span class="p">=</span> <span class="s">"(917) 479 1349"</span><span class="p">,</span>
                            <span class="n">phone_ext</span> <span class="p">=</span> <span class="s">"5478"</span><span class="p">,</span>
                            <span class="n">phone_type</span> <span class="p">=</span> <span class="s">"M"</span>
                        <span class="p">},</span>
                        <span class="n">record_format</span> <span class="p">=</span> <span class="s">"CC"</span>
                    <span class="p">};</span>

                    <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">authOnly</span><span class="p">);</span>

                    <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                    <span class="p">}</span>

                    <span class="k">try</span>
                    <span class="p">{</span>
                        <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                        <span class="p">{</span>
                            <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                                <span class="p">{</span>
                                    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                    <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                    <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Transaction Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                            <span class="p">{</span>
                                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                                <span class="p">{</span>
                                    <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</code></pre>
<pre><code class="highlight json"><span class="w">
    </span><span class="p">{</span><span class="w">
    </span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10002</span><span class="p">,</span><span class="w">
         </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"base_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"shipping_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.23</span><span class="w">
          </span><span class="p">},</span><span class="w">
         </span><span class="s2">"tax_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.00</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"note"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Send as a gift."</span><span class="p">,</span><span class="w">
         </span><span class="s2">"invoice_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"328742"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"po_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2474-6975"</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"card_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5466410004374507"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"card_expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"202011"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"billing_address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2350 Kerner Blvd"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"billing_address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2 floor"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"billing_city"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"San Rafael"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"billing_state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"billing_zip"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"94901"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvv_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"998"</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"first_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Miguel"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"last_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"company_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Payhub Inc"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Software Engineer"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"email_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"msmith14567@payhub.com"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"web_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://payhub.com"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"phone_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 479 1349"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"phone_ext"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"phone_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"record_format"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT_CARD"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<pre><code class="highlight ruby">
    <span class="nb">require</span> <span class="s1">'uri'</span>
    <span class="nb">require</span> <span class="s1">'net/http'</span>
    <span class="nb">require</span> <span class="s1">'json'</span>

    <span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">(</span><span class="s2">"http://payhub.com/payhubws/api/v2/authonly"</span><span class="p">)</span>

    <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>

    <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"content-type"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/json'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"accept"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/json'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"authorization"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Bearer 2a5d6a73-d294-4fba-bfba-957a4948d4a3'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"cache-control"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'no-cache'</span>



    <span class="n">merchant</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"organization_id"</span><span class="o">=&gt;</span><span class="mi">10074</span><span class="p">,</span>
                <span class="s2">"terminal_id"</span><span class="o">=&gt;</span><span class="mi">134</span>
                <span class="p">}</span>

    <span class="c1"># bill data</span>
    <span class="n">bill</span><span class="o">=</span> <span class="p">{</span>
                <span class="s2">"base_amount"</span><span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">,</span>
                <span class="s2">"shipping_amount"</span><span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">,</span>
                <span class="s2">"tax_amount"</span><span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">,</span>
                <span class="s2">"note"</span><span class="o">=&gt;</span><span class="s2">"this a sample note"</span><span class="p">,</span>
                <span class="s2">"invoice_number"</span><span class="o">=&gt;</span><span class="s2">"this is an invoice"</span><span class="p">,</span>
                <span class="s2">"po_number"</span><span class="o">=&gt;</span><span class="s2">"a test po number"</span>
                <span class="p">}</span>
    <span class="c1">#Credit card data</span>
    <span class="n">card_data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"card_number"</span><span class="o">=&gt;</span><span class="s2">"4055011111111111"</span><span class="p">,</span>
                <span class="s2">"card_expiry_date"</span><span class="o">=&gt;</span><span class="s2">"202012"</span><span class="p">,</span>
                <span class="s2">"cvv_data"</span><span class="o">=&gt;</span><span class="s2">"999"</span><span class="p">,</span>
                <span class="s2">"billing_address_1"</span><span class="o">=&gt;</span><span class="s2">"2350 Kerner Blvd"</span><span class="p">,</span>
                <span class="s2">"billing_address_2"</span><span class="o">=&gt;</span><span class="s2">"On the corner"</span><span class="p">,</span>
                <span class="s2">"billing_city"</span><span class="o">=&gt;</span><span class="s2">"San Rafael"</span><span class="p">,</span>
                <span class="s2">"billing_state"</span><span class="o">=&gt;</span><span class="s2">"CA"</span><span class="p">,</span>
                <span class="s2">"billing_zip"</span><span class="o">=&gt;</span><span class="s2">"99997-0003"</span>
                <span class="p">}</span>
    <span class="c1"># Customer data</span>
    <span class="n">customer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"first_name"</span><span class="o">=&gt;</span><span class="s2">"First"</span><span class="p">,</span>
                <span class="s2">"last_name"</span><span class="o">=&gt;</span><span class="s2">"Contact"</span><span class="p">,</span>
                <span class="s2">"company_name"</span><span class="o">=&gt;</span><span class="s2">"Payhub Inc"</span><span class="p">,</span>
                <span class="s2">"job_title"</span><span class="o">=&gt;</span><span class="s2">"Software Engineer"</span><span class="p">,</span>
                <span class="s2">"email_address"</span><span class="o">=&gt;</span><span class="s2">"jhon@company.com"</span><span class="p">,</span>
                <span class="s2">"web_address"</span><span class="o">=&gt;</span><span class="s2">"http://payhub.com"</span><span class="p">,</span>
                <span class="s2">"phone_number"</span><span class="o">=&gt;</span><span class="s2">"(415) 479 1349"</span><span class="p">,</span>
                <span class="s2">"phone_ext"</span><span class="o">=&gt;</span><span class="s2">"123"</span><span class="p">,</span>
                <span class="s2">"phone_type"</span><span class="o">=&gt;</span><span class="s2">"M"</span>
    <span class="p">}</span>


    <span class="n">informationToSend</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"merchant"</span><span class="o">=&gt;</span><span class="n">merchant</span><span class="p">,</span><span class="s2">"bill"</span><span class="o">=&gt;</span><span class="n">bill</span><span class="p">,</span><span class="s2">"customer"</span><span class="o">=&gt;</span><span class="n">customer</span><span class="p">,</span><span class="s2">"card_data"</span><span class="o">=&gt;</span><span class="n">card_data</span><span class="p">}</span>

    <span class="n">request</span><span class="p">.</span><span class="nf">body</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="n">informationToSend</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="nb">puts</span> <span class="n">response</span><span class="p">.</span><span class="nf">read_body</span>
</code></pre>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
