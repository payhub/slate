<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_capture_transaction">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.jpg" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="capture-transaction">Capture Transaction</h1>

<pre><code class="highlight java"><span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Void</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">RunCapture</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
      <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
      <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.payhub.com/api/v2/capture"</span><span class="o">;</span>

      <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span> <span class="c1">//You put your org id here</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>

      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"transaction_id"</span><span class="o">,</span> <span class="s">"223"</span><span class="o">);</span> <span class="c1">//You put the transaction id of the sale or refund you want to void</span>

      <span class="n">JSONObject</span> <span class="n">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">JSONObject</span> <span class="n">base_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">base_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"1275"</span><span class="o">);</span><span class="c1">//$12.75</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"base_amount"</span><span class="o">,</span> <span class="n">base_amount</span><span class="o">);</span>
      <span class="n">JSONObject</span> <span class="n">shipping_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">shipping_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"725"</span><span class="o">);</span><span class="c1">//$7.25</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"shipping_amount"</span><span class="o">,</span> <span class="n">shipping_amount</span><span class="o">);</span>
      <span class="n">JSONObject</span> <span class="n">tax_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">tax_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"113"</span><span class="o">);</span><span class="c1">//$1.13</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"tax_amount"</span><span class="o">,</span> <span class="n">tax_amount</span><span class="o">);</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"note"</span><span class="o">,</span> <span class="s">"Shipped as a gift"</span><span class="o">);</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"invoice_number"</span><span class="o">,</span> <span class="s">"4645782"</span><span class="o">);</span>
      <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"po_number"</span><span class="o">,</span> <span class="s">"1234-654321"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"bill"</span><span class="o">,</span> <span class="n">bill</span><span class="o">);</span>

      <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

      <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
      <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span> <span class="c1">//You return this response and work with it</span>

      <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
      <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
      <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
            <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
        <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
            <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Transaction Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span>
          <span class="o">}</span>

        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="o">}</span>


    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>


<span class="o">}</span>
</code></pre>

<pre><code class="highlight php">
    <span class="cp">&lt;?php</span>
      <span class="nv">$trans_type</span> <span class="o">=</span> <span class="s2">"capture"</span><span class="p">;</span>
      <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
      <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

      <span class="c1">//Defining the Web Service URL
</span>      <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"https://api.payhub.com/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


      <span class="c1">//Defining data for the VOID transaction
</span>      <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>      <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
      <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>
      <span class="nv">$transaction_id</span><span class="o">=</span><span class="s2">"83"</span><span class="p">;</span>

      <span class="c1">// bill data
</span>        <span class="nv">$base_amount</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
        <span class="nv">$shipping_amount</span> <span class="o">=</span> <span class="mf">1.23</span><span class="p">;</span>
        <span class="nv">$tax_amount</span> <span class="o">=</span> <span class="mf">1.00</span><span class="p">;</span>
        <span class="nv">$note</span> <span class="o">=</span> <span class="s2">"this a sample note"</span><span class="p">;</span>
        <span class="nv">$invoice_number</span> <span class="o">=</span> <span class="s2">"a-00240"</span><span class="p">;</span>
        <span class="nv">$po_number</span> <span class="o">=</span> <span class="s2">"56"</span><span class="p">;</span>


      <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>      <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"transaction_id"</span><span class="p">]</span><span class="o">=</span><span class="nv">$transaction_id</span><span class="p">;</span>
      <span class="nv">$data</span><span class="p">[</span><span class="s2">"bill"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"base_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$base_amount</span><span class="p">),</span>
            <span class="s2">"shipping_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$shipping_amount</span><span class="p">),</span>
            <span class="s2">"tax_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$tax_amount</span><span class="p">));</span>

      <span class="c1">//Convert data from Array to JSON
</span>      <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

      <span class="c1">//Creating a CURL object to access the WS
</span>      <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
      <span class="c1">//Setting the address to connect to
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
      <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
      <span class="c1">//Setting data in JSON format
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
      <span class="c1">//Setting the proper header.
</span>      <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
        <span class="s1">'Accept: application/json'</span><span class="p">,</span>
        <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
        <span class="p">);</span>
      <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>      <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

      <span class="c1">//execute connection to the Web Service
</span>      <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
      <span class="c1">// get some data from the response
</span>      <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
      <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
      <span class="c1">//Get the header as string.
</span>      <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
      <span class="c1">//close connection to the Web Service
</span>      <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

      <span class="c1">//Obtain the data from the void recently created
</span>      <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
        <span class="c1">//find the url of the void (Location header in the response)
</span>        <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
        <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>        <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>        <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
        <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
        <span class="c1">//Setting the proper header.
</span>        <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
        <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="c1">//execute connection to the Web Service
</span>        <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="c1">//close connection to the Web Service
</span>        <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>        <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
        <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>        <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="c1">//There was an error with the WS
</span>      <span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
      <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>

<pre><code class="highlight csharp">
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>

    <span class="k">namespace</span> <span class="nn">PayHubSamples</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">class</span> <span class="nc">Void</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunCapture</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"https://api.payhub.com/api/v2/capture"</span><span class="p">);</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                    <span class="n">var</span> <span class="n">capture</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                            <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                        <span class="p">},</span>
                        <span class="n">transaction_id</span> <span class="p">=</span> <span class="s">"238"</span><span class="p">,</span>
                        <span class="n">bill</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">base_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"1275"</span> <span class="c1">//$12.75
</span>                            <span class="p">},</span>
                            <span class="n">shipping_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"725"</span> <span class="c1">//$7.25
</span>                            <span class="p">},</span>
                            <span class="n">tax_amount</span> <span class="p">=</span> <span class="k">new</span>
                            <span class="p">{</span>
                                <span class="n">amount</span> <span class="p">=</span> <span class="s">"113"</span> <span class="c1">//$1.13
</span>                            <span class="p">},</span>
                            <span class="n">note</span> <span class="p">=</span> <span class="s">"Shipped as a gift"</span><span class="p">,</span>
                            <span class="n">invoice_number</span> <span class="p">=</span> <span class="s">"4645782"</span><span class="p">,</span>
                            <span class="n">po_number</span> <span class="p">=</span> <span class="s">"1234-654321"</span>
                        <span class="p">}</span>
                    <span class="p">};</span>

                    <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">capture</span><span class="p">);</span>

                    <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                    <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                        <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                    <span class="p">}</span>

                    <span class="k">try</span>
                    <span class="p">{</span>
                        <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                        <span class="p">{</span>
                            <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                                <span class="p">{</span>
                                    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                    <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                    <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Transaction Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                            <span class="p">{</span>
                                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                                <span class="p">{</span>
                                    <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>

<pre><code class="highlight json"><span class="w">
    </span><span class="p">{</span><span class="w">
         </span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
             </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">

         </span><span class="p">},</span><span class="w">

         </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"365"</span><span class="p">,</span><span class="w">

         </span><span class="s2">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

             </span><span class="s2">"base_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">6.00</span><span class="w">
             </span><span class="p">},</span><span class="w">
             </span><span class="s2">"shipping_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="w">
             </span><span class="p">},</span><span class="w">
             </span><span class="s2">"tax_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="w">
             </span><span class="p">},</span><span class="w">
             </span><span class="s2">"note"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Nice guest, giving him 20% discount."</span><span class="p">,</span><span class="w">
             </span><span class="s2">"invoice_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"789468"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"po_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"789468-CAP"</span><span class="w">
         </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>

<pre><code class="highlight ruby">
    <span class="nb">require</span> <span class="s1">'uri'</span>
    <span class="nb">require</span> <span class="s1">'net/http'</span>
    <span class="nb">require</span> <span class="s1">'json'</span>

    <span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">(</span><span class="s2">"https://api.payhub.com/api/v2/capture"</span><span class="p">)</span>

    <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>

    <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"content-type"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/json'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"accept"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/json'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"authorization"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Bearer 2a5d6a73-d294-4fba-bfba-957a4948d4a3'</span>
    <span class="n">request</span><span class="p">[</span><span class="s2">"cache-control"</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'no-cache'</span>



    <span class="n">merchant</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"organization_id"</span><span class="o">=&gt;</span><span class="mi">10074</span><span class="p">,</span>
                <span class="s2">"terminal_id"</span><span class="o">=&gt;</span><span class="mi">134</span>
                <span class="p">}</span>

    <span class="c1"># bill data</span>
    <span class="n">bill</span><span class="o">=</span> <span class="p">{</span>
            <span class="s2">"base_amount"</span><span class="o">=&gt;</span><span class="no">Hash</span><span class="p">[</span><span class="s2">"amount"</span> <span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">],</span>
            <span class="s2">"shipping_amount"</span><span class="o">=&gt;</span><span class="no">Hash</span><span class="p">[</span><span class="s2">"amount"</span> <span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">],</span>
            <span class="s2">"tax_amount"</span><span class="o">=&gt;</span><span class="no">Hash</span><span class="p">[</span><span class="s2">"amount"</span> <span class="o">=&gt;</span><span class="s2">"1.00"</span><span class="p">],</span>
            <span class="s2">"note"</span><span class="o">=&gt;</span><span class="s2">"this a sample note"</span><span class="p">,</span>
            <span class="s2">"invoice_number"</span><span class="o">=&gt;</span><span class="s2">"this is an invoice"</span><span class="p">,</span>
            <span class="s2">"po_number"</span><span class="o">=&gt;</span><span class="s2">"a test po number"</span>
    <span class="p">}</span>
    <span class="c1">#transaction Id</span>
    <span class="n">transaction_id</span><span class="o">=</span><span class="s2">"114"</span>

    <span class="n">informationToSend</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"merchant"</span><span class="o">=&gt;</span><span class="n">merchant</span><span class="p">,</span><span class="s2">"bill"</span><span class="o">=&gt;</span><span class="n">bill</span><span class="p">,</span><span class="s2">"transaction_id"</span><span class="o">=&gt;</span><span class="n">transaction_id</span><span class="p">}</span>

    <span class="n">request</span><span class="p">.</span><span class="nf">body</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="n">informationToSend</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="nb">puts</span> <span class="n">response</span><span class="p">.</span><span class="nf">read_body</span>
</code></pre>

<h2 id="introduction">Introduction</h2>

<p>This topic provides information about the <strong>Capture</strong> transaction.</p>

<p>Use the Capture transaction as the final step to collect the funds that you had asked for authorization through the AuthOnly transaction. You need to provide the transaction ID that you receive when you run the <strong>AuthOnly</strong> transaction.</p>

<p>In case the order fulfilment process, such as <em>shipping goods some days after they were ordered</em>, is delayed you might want to first run the AuthOnly transaction and then capture the respective funds. You might also need to change the amount that you got an authorization for. In that case, you need to provide a new bill section, including base amount and, if required, shipping amount, tax amount, invoice number, PO number, and note.</p>

<p>If the Capture transaction executes successfully, you will receive a 201 Created code. This code will include the transaction id. This transaction ID should be the same ID that you provided, which means, the same transaction id of the AuthOnly transaction that you just captured.</p>

<p>After capturing the amount for the AuthOnly transaction, the transaction will become a sale. The money will be taken from the card holders account and credited to your account during the settlement of the sale.</p>

<h3 id="request-method">Request Method</h3>

<h3 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h3>

<p><code class="prettyprint">https://api.payhub.com/api/v2/capture</code></p>

<h2 id="elements">Elements</h2>

<h3 id="merchant-(required)">merchant (required)</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The organization id of the merchant who did the AuthOnly that you are trying to capture.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The terminal&rsquo;s id of the merchant where the AuthOnly was done.</td>
</tr>
</tbody></table>

<h3 id="transaction_id-(integer,-required)">transaction_id (integer, required)</h3>

<p>The transaction id of the AuthOnly that you want to capture.</p>

<h3 id="bill-(optional)">bill (optional)</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>base_amount</td>
<td>TransactionAmount</td>
<td>The base amount of the recurring bill. The total amount charged will be the sum of this amount and the &lsquo;shipping_amount&rsquo;, &#39;tax_amount&rsquo; if any.</td>
</tr>
<tr>
<td>shipping_amount</td>
<td>TransactionAmount, optional</td>
<td>The shipping amount for the transaction. This amount will be included in the total amount charged.</td>
</tr>
<tr>
<td>tax_amount</td>
<td>TransactionAmount, optional</td>
<td>The tax amount for the transaction. This amount will be included in the total amount charged.</td>
</tr>
<tr>
<td>invoice_number</td>
<td>string, optional</td>
<td>The invoice number of the transaction.</td>
</tr>
<tr>
<td>po_number</td>
<td>string, optional</td>
<td>The purchase order number of the transaction.</td>
</tr>
<tr>
<td>note</td>
<td>string, optional</td>
<td>A free format note for the transaction. The note will be read by the Merchant.</td>
</tr>
</tbody></table>

<h2 id="response" style="clear: right;">Response</h2>

<pre><code class="highlight shell">    <span class="o">{</span>
        <span class="s2">"id"</span>: <span class="s2">"777"</span>,
        <span class="s2">"version"</span>: 0,
        <span class="s2">"createdAt"</span>: <span class="s2">"2015-05-14T11:19:43.583-07:00"</span>,
        <span class="s2">"lastModified"</span>: <span class="s2">"2015-05-14T11:19:43.583-07:00"</span>,
        <span class="s2">"createdBy"</span>: <span class="s2">"10127"</span>,
        <span class="s2">"lastModifiedBy"</span>: <span class="s2">"10127"</span>,
        <span class="s2">"metaData"</span>: null,
        <span class="s2">"merchant"</span>: <span class="o">{</span>
            <span class="s2">"id"</span>: <span class="s2">"10127215"</span>,
            <span class="s2">"version"</span>: 1,
            <span class="s2">"createdAt"</span>: <span class="s2">"2015-04-02T11:46:16.676-07:00"</span>,
            <span class="s2">"lastModified"</span>: <span class="s2">"2015-04-28T13:28:21.427-07:00"</span>,
            <span class="s2">"createdBy"</span>: <span class="s2">"10127"</span>,
            <span class="s2">"lastModifiedBy"</span>: <span class="s2">"10127"</span>,
            <span class="s2">"metaData"</span>: null,
            <span class="s2">"organization_id"</span>: 10127,
            <span class="s2">"terminal_id"</span>: 215
        <span class="o">}</span>,
        <span class="s2">"bill"</span>: null,
        <span class="s2">"transaction_id"</span>: 114,
        <span class="s2">"lastCaptureResponse"</span>: <span class="o">{</span>
            <span class="s2">"batchId"</span>: <span class="s2">"702"</span>,
            <span class="s2">"transactionId"</span>: <span class="s2">"114"</span>,
            <span class="s2">"billingReferences"</span>: null
        <span class="o">}</span>,
        <span class="s2">"_links"</span>: <span class="o">{</span>
            <span class="s2">"self"</span>: <span class="o">{</span>
                <span class="s2">"href"</span>: <span class="s2">"https://api.payhub.com/api/v2/capture/777"</span>
            <span class="o">}</span>,
            <span class="s2">"merchant"</span>: <span class="o">{</span>
                <span class="s2">"href"</span>: <span class="s2">"https://api.payhub.com/api/v2/capture/777/merchant"</span>
            <span class="o">}</span>,
            <span class="s2">"bill"</span>: <span class="o">{</span>
                <span class="s2">"href"</span>: <span class="s2">"https://api.payhub.com/api/v2/capture/777/bill"</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>

<h3 id="result">Result</h3>

<ul>
<li>201 code (created)</li>
<li>The Id of the Capture in the Location header. This ID should be the same that you provided. 
<br>Sample header in the response:Location: https://api.payhub.com/api/v2/authOnly/234</li>
</ul>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
