<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_webhook_for_integrators">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.jpg" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="payhub-webhook">PayHub Webhook</h1>

<h2 id="configuration-process">Configuration Process</h2>

<p><strong>With this new service you can receive a notification in two cases:</strong></p>

<ul>
<li><strong>for each transaction in your account.</strong></li>
<li><strong>when a batch was settled.</strong></li>
</ul>

<p>Go to your Merchant Administration and select <code class="prettyprint">Webhook Configuration</code>.</p>

<p><img src="../images/webhook-admin.png" /></p>

<p>There, you will see your current webhook configuration.</p>

<p>From this page, you can enter your website url and select those services for which you would like to receive notifications. 
Also, once that the webhook is configured, you can disable or enable it at any time.</p>

<h2 id="services">Services</h2>

<h3 id="transaction-services">Transaction Services</h3>

<ul>
<li>VirtualHub</li>
<li>MobileHub</li>
<li>Recurring Billing</li>
<li>API</li>
</ul>

<h3 id="batch-service">Batch Service</h3>

<ul>
<li>Batch</li>
</ul>

<h2 id="requirements">Requirements</h2>

<ul>
<li>The endpoint validation only allows HTTPS.</li>
<li>The controller for your endpoint must be implemented with a POST method.</li>
<li>The controller for your endpoint must be set to accept JSON.</li>
</ul>

<p><img src="../images/webhook-admin-config.png" /></p>

<p>After you have saved your configuration (by selecting the green &ldquo;Update&rdquo; button), our service will send you a notification for each event that occurs on your account to the endpoint that you have indicated.</p>

<h2 id="events">Events</h2>

<p>There are two kinds of events: transactions and settled batches.</p>

<h2 id="transaction-message-from-webhook-to-your-endpoint">Transaction Message from Webhook to your endpoint</h2>

<h3 id="the-json-message-is-as-follows:">The JSON message is as follows:</h3>
<pre><code class="highlight shell">    <span class="o">{</span>
        <span class="s2">"endpoint"</span>: <span class="s2">"https://yoursite.com/your_controller/"</span>,
        <span class="s2">"eventType"</span>: <span class="s2">"transaction"</span>,
        <span class="s2">"event"</span>: <span class="o">{</span>
            <span class="s2">"type"</span>: <span class="o">{</span>
                <span class="s2">"transaction"</span>: <span class="o">{</span>
                    <span class="s2">"transactionType"</span>: <span class="s2">"Sale"</span>,
                    <span class="s2">"recurringBillId"</span>: <span class="s2">""</span>,
                    <span class="s2">"responseText"</span>: <span class="s2">"VER UNAVAILABLE"</span>,
                    <span class="s2">"source"</span>: <span class="s2">"3rd Party API"</span>,
                    <span class="s2">"cardObscured"</span>: <span class="s2">"XXXXXXXXXXXX4507"</span>,
                    <span class="s2">"orgId"</span>: <span class="s2">"10002"</span>,
                    <span class="s2">"transactionId"</span>: <span class="s2">"721"</span>,
                    <span class="s2">"responseCode"</span>: <span class="s2">"00"</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>

<h3 id="fields-meaning">Fields Meaning</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>endpoint</td>
<td>String</td>
<td>Your site endpoint to receive the notifications</td>
</tr>
<tr>
<td>eventType</td>
<td>String</td>
<td>In this case the type is always &ldquo;transaction&rdquo;</td>
</tr>
<tr>
<td>batch_settled</td>
<td>Object</td>
<td>JSON object with batch information</td>
</tr>
<tr>
<td>transaction</td>
<td>String</td>
<td>Possible values: <br><ul><li> &ldquo;Sale&rdquo; </li><li> &ldquo;Authorization Only&rdquo; </li><li> &ldquo;Offline&rdquo; </li> <li>&ldquo;Void&rdquo;</li><li>&ldquo;Refund&rdquo;</li></ul></td>
</tr>
<tr>
<td>source</td>
<td>String</td>
<td>Possible values: <br><ul><li>&ldquo;Virtual Terminal&rdquo;</li><li>&ldquo;3rd Party API&rdquo;</li><li>&ldquo;Recurring&rdquo;</li><li>&ldquo;Mobile VT&rdquo;</li></ul></td>
</tr>
<tr>
<td>orgId</td>
<td>String</td>
<td>String</td>
</tr>
<tr>
<td>transactionId</td>
<td>String</td>
<td>The transaction id.</td>
</tr>
<tr>
<td>recurringBillId</td>
<td>String</td>
<td>The recurring bill id if the transaction was scheduled.</td>
</tr>
<tr>
<td>cardObscured</td>
<td>String</td>
<td>the obscured card entered for the transaction.</td>
</tr>
<tr>
<td>responseText</td>
<td>String</td>
<td>A descriptive text of the transaction result.</td>
</tr>
<tr>
<td>responseCode</td>
<td>String</td>
<td>The code for the transaction result.</td>
</tr>
</tbody></table>

<h2 id="batch-message-from-webhook-to-your-endpoint">Batch Message from Webhook to your endpoint</h2>

<h3 id="the-json-message-is-at-follows:">The JSON message is at follows:</h3>
<pre><code class="highlight shell">
    <span class="o">{</span>
        <span class="s2">"endpoint"</span>: <span class="s2">"https://yoursite.com/your_controller/"</span>,
        <span class="s2">"eventType"</span>: <span class="s2">"batch_settled"</span>,
        <span class="s2">"event"</span>: <span class="o">{</span>
            <span class="s2">"type"</span>: <span class="o">{</span>
                <span class="s2">"batch_settled"</span>: <span class="o">{</span>
                    <span class="s2">"date"</span>: <span class="s2">"Thu Oct 29 11:23:11 ART 2015"</span>,
                    <span class="s2">"batch_id"</span>: <span class="s2">"102"</span>,
                    <span class="s2">"net_total"</span>: <span class="s2">"15"</span>,
                    <span class="s2">"terminal"</span>: <span class="s2">"Virtual Hub"</span>,
                    <span class="s2">"trans_count"</span>: <span class="s2">"15"</span>,
                    <span class="s2">"status"</span>: <span class="s2">"Settled"</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

</code></pre>

<h3 id="fields-meaning">Fields Meaning</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>endpoint</td>
<td>String</td>
<td>Your site endpoint to receive the notifications</td>
</tr>
<tr>
<td>eventType</td>
<td>String</td>
<td>In this case the type is always &ldquo;batch_settled&rdquo;</td>
</tr>
<tr>
<td>batch_settled</td>
<td>Object</td>
<td>JSON object with batch information</td>
</tr>
<tr>
<td>date</td>
<td>String</td>
<td>Date.</td>
</tr>
<tr>
<td>batch_id</td>
<td>String</td>
<td>The batch id.</td>
</tr>
<tr>
<td>net_total</td>
<td>String</td>
<td>The total amount of money</td>
</tr>
<tr>
<td>terminal</td>
<td>String</td>
<td>The terminal name.</td>
</tr>
<tr>
<td>trans_count</td>
<td>String</td>
<td>The number of transaction that were settled on the batch.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The batch status .</td>
</tr>
</tbody></table>

        <!--
        -->
      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
