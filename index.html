<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PayHub API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["java","php","csharp","json"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.jpg" />
        <div class="lang-selector">
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="php">php</a>
              <a href="#" data-language-name="csharp">csharp</a>
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="errors">Errors</h1>

<aside class="notice">This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the `includes` folder and add them to the top of your `index.md`&rsquo;s frontmatter. Files are included in the order listed.</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error CodE</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>00</td>
<td>VALID_OPERATION</td>
</tr>
<tr>
<td>02</td>
<td>CARD_NUMBER_MISSING_CODE</td>
</tr>
<tr>
<td>1009</td>
<td>INVALID_REFERENCE_NUMBER</td>
</tr>
<tr>
<td>4006</td>
<td>INVALID_MERCHANT</td>
</tr>
<tr>
<td>4007</td>
<td>INVALID_TERMINAL</td>
</tr>
<tr>
<td>4008</td>
<td>INVALID_USER_NAME</td>
</tr>
<tr>
<td>4009</td>
<td>INVALID_USER_PASSWORD</td>
</tr>
<tr>
<td>4010</td>
<td>INVALID_RECORD_FORMAT</td>
</tr>
<tr>
<td>4011</td>
<td>INACTIVE_TERMINAL</td>
</tr>
<tr>
<td>4012</td>
<td>INVALID_AUTHENTICATION</td>
</tr>
<tr>
<td>4013</td>
<td>INVALID_TRANSACTION_CD</td>
</tr>
<tr>
<td>4014</td>
<td>INVALID_OFFLINE_APPROVAL_CD</td>
</tr>
<tr>
<td>4015</td>
<td>INVALID_CARDHOLDER_ID_CODE</td>
</tr>
<tr>
<td>4016</td>
<td>INVALID_CARD_HOLDER_ID_DATA</td>
</tr>
<tr>
<td>4017</td>
<td>INVALID_ACCOUNT_DATA_SOURCE</td>
</tr>
<tr>
<td>4018</td>
<td>INVALID_CUSTOMER_DATA_FIELD</td>
</tr>
<tr>
<td>4019</td>
<td>INVALID_CVV_CODE</td>
</tr>
<tr>
<td>4020</td>
<td>INVALID_CVV_DATA</td>
</tr>
<tr>
<td>4021</td>
<td>INVALID_TRANSACTION_AMOUNT</td>
</tr>
<tr>
<td>4022</td>
<td>INVALID_CARD_NUMBER</td>
</tr>
<tr>
<td>4023</td>
<td>INVALID_BATCH_ID</td>
</tr>
<tr>
<td>4024</td>
<td>INVALID_TRANSACTION_ID</td>
</tr>
<tr>
<td>4025</td>
<td>INVALID_CARD_EXPIRY_DATE</td>
</tr>
<tr>
<td>4026</td>
<td>INVALID_AVS_DATA_FLAG</td>
</tr>
<tr>
<td>4027</td>
<td>INVALID_CUSTOMER_ID</td>
</tr>
<tr>
<td>4028</td>
<td>INVALID_CUSTOMER_WEB</td>
</tr>
<tr>
<td>4029</td>
<td>INVALID_CUSTOMER_EMAIL_ID</td>
</tr>
<tr>
<td>4030</td>
<td>INVALID_CUSTOMER_BILLING_ADD_ZIP</td>
</tr>
<tr>
<td>4031</td>
<td>INVALID_CUSTOMER_SHIPPING_ADD_ZIP</td>
</tr>
<tr>
<td>4032</td>
<td>INACTIVE_MERCHANT</td>
</tr>
<tr>
<td>4033</td>
<td>INVALID_TERMINAL_ORIGIN</td>
</tr>
<tr>
<td>4034</td>
<td>INVALID_CARD_DATA_FOR_DEBIT</td>
</tr>
<tr>
<td>4035</td>
<td>INVALID_TRANSACTION_CODE_FOR_DEBIT</td>
</tr>
<tr>
<td>4036</td>
<td>INVALID_CUSTOMER_ADDRESS</td>
</tr>
<tr>
<td>4037</td>
<td>INVALID_CUSTOMER_COMPANY_NAME</td>
</tr>
<tr>
<td>4038</td>
<td>INVALID_CUSTOMER_DATA</td>
</tr>
<tr>
<td>4039</td>
<td>INVALID_TRANSACTION_NOTE</td>
</tr>
<tr>
<td>4040</td>
<td>CARD_NOT_SUPPORT_CODE</td>
</tr>
<tr>
<td>4041</td>
<td>CVV_REQUIRED_CODE</td>
</tr>
<tr>
<td>4042</td>
<td>AVS_REQUIRED_CODE</td>
</tr>
<tr>
<td>4043</td>
<td>CARD_REQUIRED_CODE</td>
</tr>
<tr>
<td>4044</td>
<td>EXPIRY_REQUIRED_CODE</td>
</tr>
<tr>
<td>4045</td>
<td>TRACK_DATA_REQUIRED_CODE</td>
</tr>
<tr>
<td>4046</td>
<td>CARD_TOKEN_GENRATION_FAILED_CODE</td>
</tr>
<tr>
<td>4047</td>
<td>PAYMENT_TYPE_REQUIRED_CODE</td>
</tr>
<tr>
<td>4048</td>
<td>TRANSACTION_TYPE_REQUIRED_CODE</td>
</tr>
<tr>
<td>4049</td>
<td>TRANSACTION_ID_REQUIRED_CODE</td>
</tr>
<tr>
<td>4050</td>
<td>BATCH_ID_REQUIRED_CODE</td>
</tr>
<tr>
<td>4051</td>
<td>TERMINAL_ID_REQUIRED_CODE</td>
</tr>
<tr>
<td>4052</td>
<td>ORGANIZATION_REQUIRED_CODE</td>
</tr>
<tr>
<td>4053</td>
<td>BATCH_TRANSACTION_NOT_FOUND_CODE</td>
</tr>
<tr>
<td>4054</td>
<td>ALREADY_SETTLED_BATCH_CODE</td>
</tr>
<tr>
<td>4055</td>
<td>DUPLICATE_BATCH_CODE</td>
</tr>
<tr>
<td>4056</td>
<td>BATCH_SETTLED_SUCCESSFULLY_CODE</td>
</tr>
<tr>
<td>4057</td>
<td>BATCH_SETTLEMENT_FAILD_CODE</td>
</tr>
<tr>
<td>4058</td>
<td>BATCH_REJECTED_CODE</td>
</tr>
<tr>
<td>4059</td>
<td>NETWORK_UNAVAILABLE_CODE</td>
</tr>
<tr>
<td>4060</td>
<td>UNABLE_TO_BUILT_REQUEST_CODE</td>
</tr>
<tr>
<td>4061</td>
<td>RECORD_NOT_FOUND_CODE</td>
</tr>
<tr>
<td>4062</td>
<td>RECURRING_SAVED_CODE</td>
</tr>
<tr>
<td>4063</td>
<td>RECURRING_SAVING_FAILED_CODE</td>
</tr>
<tr>
<td>4064</td>
<td>RECURRING_UPDATION_CODE</td>
</tr>
<tr>
<td>4065</td>
<td>RECURRING_UPDATION_FAILED_CODE</td>
</tr>
<tr>
<td>4066</td>
<td>RECURRING_STATUS_CHANGED_SUCCESSFULLY</td>
</tr>
<tr>
<td>4067</td>
<td>RECURRING_STATUS_CHANGING_FAILED</td>
</tr>
<tr>
<td>4068</td>
<td>INVALID_TRANSACTION_ID_CODE</td>
</tr>
<tr>
<td>4069</td>
<td>TRANSACTION_ALREADY_VOIDED_CODE</td>
</tr>
<tr>
<td>4070</td>
<td>CARD_TYPE_REQUIRED_CODE</td>
</tr>
<tr>
<td>4071</td>
<td>INVALID_BATCH_NO_CODE</td>
</tr>
<tr>
<td>4072</td>
<td>TRANSACTION_ALREADY_REFUNDED_CODE</td>
</tr>
<tr>
<td>4073</td>
<td>UNABLE_TO_VOID_CODE</td>
</tr>
<tr>
<td>4074</td>
<td>UNABLE_TO_REFUND_CODE</td>
</tr>
<tr>
<td>4075</td>
<td>UNABLE_TO_CAPTURE_CODE</td>
</tr>
<tr>
<td>4076</td>
<td>CAPTURED_TRANSACTION_SENT_CODE</td>
</tr>
<tr>
<td>4077</td>
<td>CAPTURED_TRANSACTION_FAILED_CODE</td>
</tr>
<tr>
<td>4078</td>
<td>INVALID_INVOICE_NUMBER</td>
</tr>
<tr>
<td>4080</td>
<td>INVALID_BILL_TYPE_CODE</td>
</tr>
<tr>
<td>4081</td>
<td>INVALID_BILL_GENERATION_SPAN_CODE</td>
</tr>
<tr>
<td>4082</td>
<td>INVALID_END_DATE_TYPE_CODE</td>
</tr>
<tr>
<td>4083</td>
<td>INVALID_END_BILL_COUNT_CODE</td>
</tr>
<tr>
<td>4084</td>
<td>INVALID_END_BILL_DATE_CODE</td>
</tr>
<tr>
<td>4085</td>
<td>INVALID_WEEK_DAYS_CODE</td>
</tr>
<tr>
<td>4086</td>
<td>INVALID_MONTHLY_TYPE_CODE</td>
</tr>
<tr>
<td>4087</td>
<td>INVALID_MONTHLY_WEEK_DAYS_CODE</td>
</tr>
<tr>
<td>4088</td>
<td>INVALID_MONTHLY_DAYS_POSSION_CODE</td>
</tr>
<tr>
<td>4089</td>
<td>INVALID_MONTHLY_DAYS_CODE</td>
</tr>
<tr>
<td>4090</td>
<td>INVALID_START_DATE_CODE</td>
</tr>
<tr>
<td>4091</td>
<td>INVALID_SPECIFIC_DATES_CODE</td>
</tr>
<tr>
<td>4092</td>
<td>SPECIFIC_SAME_DATES_CODE</td>
</tr>
<tr>
<td>4093</td>
<td>INVALID_RECURRING_DATA_CODE</td>
</tr>
<tr>
<td>4094</td>
<td>END_BILL_DATE_BEFORE_START_CODE</td>
</tr>
<tr>
<td>4095</td>
<td>CARD_HOLDER_DATA_REQUIRED_CODE</td>
</tr>
<tr>
<td>4096</td>
<td>CARD_HOLDER_CODE_REQUIRED_CODE</td>
</tr>
<tr>
<td>4097</td>
<td>INVALID_STATUS_CODE</td>
</tr>
<tr>
<td>4098</td>
<td>UNABLE_TO_CHANGE_STATUS</td>
</tr>
<tr>
<td>4099</td>
<td>CARD_VALIDATION_FAILED_CODE</td>
</tr>
<tr>
<td>4100</td>
<td>RECURRING_CIS_FAILED_CODE</td>
</tr>
<tr>
<td>4101</td>
<td>UNABLE_BUILT_RECURRING_FILTER__CODE</td>
</tr>
<tr>
<td>4103</td>
<td>UNABLE_TO_BUILT_NEXT_BILL_CODE</td>
</tr>
<tr>
<td>4501</td>
<td>INVALID_PHONE_TYPE</td>
</tr>
<tr>
<td>4502</td>
<td>INVALID_PHONE_NUMBER</td>
</tr>
<tr>
<td>4503</td>
<td>INVALID_ZIP_CODE</td>
</tr>
<tr>
<td>4504</td>
<td>INVALID_STATE_CODE</td>
</tr>
<tr>
<td>4505</td>
<td>INVALID_INTERVAL_TYPE</td>
</tr>
<tr>
<td>4506</td>
<td>INVALID_END_DATE</td>
</tr>
<tr>
<td>4507</td>
<td>INVALID_BILL_WEEKLY_DAYS</td>
</tr>
<tr>
<td>4508</td>
<td>INVALID_YEAR_MONTH_DAYS</td>
</tr>
<tr>
<td>4509</td>
<td>INVALID_YEAR_BILL_ON_MONTH_NO</td>
</tr>
<tr>
<td>4510</td>
<td>INVALID_MONTHLY_BILL_TYPE</td>
</tr>
<tr>
<td>4511</td>
<td>INVALID_MDAYS_POSITION</td>
</tr>
<tr>
<td>4512</td>
<td>INVALID_MDAYS</td>
</tr>
<tr>
<td>4513</td>
<td>INVALID_MDAY_EACH_POSITIONS</td>
</tr>
<tr>
<td>4514</td>
<td>INCONSISTENT_SCHEDULE_FIELDS</td>
</tr>
<tr>
<td>4515</td>
<td>ACCOUNT_IS_NOT_ADMINISTRATOR</td>
</tr>
<tr>
<td>4516</td>
<td>INCONSISTENT_CARD_DATA_FIELDS</td>
</tr>
<tr>
<td>4517</td>
<td>WRONG_OAUTH_TOKEN_FOR_MERCHANT</td>
</tr>
<tr>
<td>4518</td>
<td>NO_MERCHANT_ACCOUNT_FOR_OUTH_TOKEN_FOR_MERCHANT</td>
</tr>
<tr>
<td>4519</td>
<td>NO_SETUP_ACCOUNT_FOR_OUTH_TOKEN_FOR_MERCHANT</td>
</tr>
<tr>
<td>4520</td>
<td>NO_VT_CLIENT_ACCOUNT_FOR_OUTH_TOKEN_FOR_MERCHANT</td>
</tr>
<tr>
<td>4521</td>
<td>INVALID_CURRENCY_CODE</td>
</tr>
<tr>
<td>4522</td>
<td>INVALID_RECURRING_BILL_STATUS_CHANGE_CODE</td>
</tr>
<tr>
<td>4523</td>
<td>INCONSISTENT_CURRENCIES</td>
</tr>
<tr>
<td>4524</td>
<td>MISSING_PROPERTY_CODE</td>
</tr>
<tr>
<td>4525</td>
<td>INCONSISTENT_CUSTOMER_DATA_CODE</td>
</tr>
<tr>
<td>4526</td>
<td>DUPLICATE_DEVELOPER_CODE</td>
</tr>
<tr>
<td>9989</td>
<td>METHOD_REQUEST_BODY_VALIDATION_ERROR_CODE</td>
</tr>
<tr>
<td>9990</td>
<td>HTTP_NOT_READABLE_EXCEPTION_CODE</td>
</tr>
<tr>
<td>9991</td>
<td>JSONPARSE_EXCEPTION_CODE</td>
</tr>
<tr>
<td>9992</td>
<td>MAPPING_EXCEPTION_CODE</td>
</tr>
<tr>
<td>9993</td>
<td>MEDIA_TYPE_NOT_SUPPORTED_CODE</td>
</tr>
<tr>
<td>9994</td>
<td>METHOD_NOT_SUPPORTED_CODE</td>
</tr>
<tr>
<td>9995</td>
<td>PAGE_NOT_FOUND_ERROR_CODE</td>
</tr>
<tr>
<td>9996</td>
<td>ACCESS_DENIED_ERROR_CODE</td>
</tr>
<tr>
<td>9997</td>
<td>JSON_SYNTAX_ERROR_CODE</td>
</tr>
<tr>
<td>9998</td>
<td>NOT_FOUND_ERROR_CODE</td>
</tr>
<tr>
<td>9999</td>
<td>INTERNAL_SERVER_ERROR_CODE</td>
</tr>
</tbody></table>

          <h1 id="authentication">Authentication</h1>

<h2 id="using-oauth-2.0-access-tokens-to-access-your-merchants&#39;-resources">Using OAuth 2.0 Access Tokens to Access your Merchants&rsquo; Resources</h2>

<aside>This document is in progress as of 03/13/2015. This line will be removed when complete - please see text in bolded-italic font that needs to be addressed before we can publish&hellip;.</aside>

<h2 id="introduction">Introduction</h2>

<p>The purpose of this document is to provide you with information on how you can get started using PayHub RESTful Web Services to access certain resources associated with a Merchant&rsquo;s PayHUb account. PayHub&rsquo;s RESTfulWeb Services allow you and your applications to act on a Merchant&rsquo;s behalf to do useful things like:</p>

<ul>
<li>Create a Sale transaction (POST a sale resource).</li>
<li>Create a Void transaction (POST a void resource).</li>
<li>Create a Refund transaction (POST a refund resource).</li>
<li>Create a Recurring Bill (POST a recurring-bill resource).</li>
<li>Update the status of a Recurring Bill, (PATCH the recurring-bill-status property of a RecurringBill resource).</li>
<li>Retrieve the schedule(s) you used to create a Recurring Bill (GET one or more schedule
resources).</li>
<li>Retrieve your Merchants&rsquo; Customer information (GET one or more customer resources), for those
Customers that you have historically created through using the service when you posted a Sale or a Recurring Bill.</li>
<li>Retrieve information about the Merchants whose resources you have historically managed (GET one or more merchant resources).</li>
<li>Retrieve your Merchants&rsquo; tokenized Card Data (GET one or more carddata resources), for the Sales or a Recurring Bills you have historically created.</li>
<li>Retrieve the bill-related data, such as transaction amount, (GET one or more bill resources), for the Sales or a Recurring Bills you have historically created.</li>
<li>Attach your own arbitrary JSON data to most of the resources you have created (PUT
metadata &lsquo;forResource&rsquo;)</li>
<li>Perform certain specialized search queries on the resources you have created.</li>
<li>Supply parameters to control paging and sorting (ascending or descending on a top level
property) on GETs that return multiple resources.</li>
<li>Query the endpoint we provide and use the hypermedia-linked feature to discover resources from within your client application.</li>
<li>Obtain, store, and use PayHub&rsquo;s unique numeric identifiers for certain resources such as Customer Id and Recurring Bill Id.</li>
</ul>

<h2 id="how-we-use-oauth-2.0-to-assure-security">How we Use OAuth 2.0 to Assure Security</h2>

<p>Oauth 2.0 is an industry-standard, and widely accepted, authentication and authorization mechanism for providing third party applications and clients secure access to a user&rsquo;s resources hosted service providers.</p>

<p>Typically, the third party (or client) is granted access to a user&rsquo;s resources hosted by a service provider, using a unique token generated by the service provider at the time the user authorizes the client access to their resources. Think of the situation where you authorize a web site to register you using your identity hosted on Facebook (you click the &#39;log in with Facebook&rsquo; button on the web site and authorize the site to access your information on Facebook).</p>

<p>The PayHub RESTful Web Services currently uses OAuth 2.0 with:</p>

<ul>
<li>You as the Client</li>
<li>Merchants as the Users (who has an account at PayHub)</li>
<li>And PayHub as the Service Provider</li>
</ul>

<p>You can think of the OAuth 2.0 token as linking the Client to the Merchant via the PayHub Service.</p>

<p>As a new third party integrator, you will be assigned a unique &#39;Client Id&rsquo; that you will use when requesting access to a Merchant&rsquo;s resources.</p>

<p>We are current working on a way for you to automatically obtain an OAuth 2.0 Token for a Merchant without the need for the Merchant or PayHub Support to first visit the PayHub Virtual Terminal to generate the token for your Client Id.</p>

<p>Once you have your token, it is very important that you treat this as you would a user and password: never reveal it to anyone other than authorized developers, and never reference it in publicly available source code such as publicly exposed JavaScript or HTML pages.</p>

<h2 id="using-your-oauth-2.0-token-in-calls-to-payhub-restful-web-services">Using Your OAuth 2.0 Token in calls to PayHub RESTful Web Services</h2>

<p>Once you have the token, you can use it to authenticate your application to the PayHub RESTful Web Service by using the OAuth 2.0 standard HTTP Authorization Header structured as in this example:</p>

<p><code>
Header Field Name: Authorization<br>
Header Value: Bearer [your-token-here]
</code></p>

<p>It is important to note that, although this token authorizes you to invoke the PayHub Restful Web Services on behalf of a particular Merchant:</p>

<ol>
<li>You will also need to know the Merchant&rsquo;s unique Organization Id and 3rd Party Terminal Id when you POST a Recurring Bill and a Sale. You should have been supplied with this information when you received the token.</li>
<li>You can use any of your valid OAuth 2.0 Tokens when performing GETs to your Merchants&rsquo; PayHub resources. A GET will retrieve all resources of the requested type (for example Customer) regardless of Merchant. You can filter by Merchant by using the
supplied findByMerchantOrganizationId search functions.
￼
￼</li>
</ol>

          <h1 id="recurring-bill-transaction">Recurring Bill Transaction</h1>

<h2 id="post">POST</h2>
<pre><code class="highlight java"><span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RecurringBill</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">CreateRecurringBill</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
      <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
      <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://payhub.com/payhubws/api/v2/recurring-bill"</span><span class="o">;</span>

      <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span><span class="c1">//You put your org id here</span>
        <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">JSONObject</span> <span class="n">base_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">base_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"1275"</span><span class="o">);</span><span class="c1">//$12.75</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"base_amount"</span><span class="o">,</span> <span class="n">base_amount</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">shipping_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">shipping_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"725"</span><span class="o">);</span><span class="c1">//$7.25</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"shipping_amount"</span><span class="o">,</span> <span class="n">shipping_amount</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">tax_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">tax_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"113"</span><span class="o">);</span><span class="c1">//$1.13</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"tax_amount"</span><span class="o">,</span> <span class="n">tax_amount</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"note"</span><span class="o">,</span> <span class="s">"Shipped as a gift"</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"invoice_number"</span><span class="o">,</span> <span class="s">"4645782"</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"po_number"</span><span class="o">,</span> <span class="s">"1234-654321"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"bill"</span><span class="o">,</span> <span class="n">bill</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">card_data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_number"</span><span class="o">,</span> <span class="s">"5466410004374507"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_expiry_date"</span><span class="o">,</span> <span class="s">"201809"</span><span class="o">);</span><span class="c1">// September 2018</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_1"</span><span class="o">,</span> <span class="s">"237 E 33rd Street"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_2"</span><span class="o">,</span> <span class="s">"3rd Floor"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_zip"</span><span class="o">,</span> <span class="s">"10016"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_city"</span><span class="o">,</span> <span class="s">"New York"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_state"</span><span class="o">,</span> <span class="s">"NY"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_data"</span><span class="o">,</span> <span class="n">card_data</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"first_name"</span><span class="o">,</span> <span class="s">"John"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"last_name"</span><span class="o">,</span> <span class="s">"Smith"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"company_name"</span><span class="o">,</span> <span class="s">"CBA Steakhouse"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"job_title"</span><span class="o">,</span> <span class="s">"Owner"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email_address"</span><span class="o">,</span> <span class="s">"john@cbasteakhouse.com"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_number"</span><span class="o">,</span> <span class="s">"(917) 479 1349"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_ext"</span><span class="o">,</span> <span class="s">"5478"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_type"</span><span class="o">,</span> <span class="s">"M"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="n">customer</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">schedule</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">schedule</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"schedule_type"</span><span class="o">,</span> <span class="s">"S"</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">specific_dates_schedule</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">JSONArray</span> <span class="n">specific_dates</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONArray</span><span class="o">();</span>
            <span class="n">specific_dates</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="s">"2016-02-01"</span><span class="o">);</span>
            <span class="n">specific_dates</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="s">"2016-10-31"</span><span class="o">);</span>
          <span class="n">specific_dates_schedule</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"specific_dates"</span><span class="o">,</span> <span class="n">specific_dates</span><span class="o">);</span>
        <span class="n">schedule</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"specific_dates_schedule"</span><span class="o">,</span> <span class="n">specific_dates_schedule</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"schedule"</span><span class="o">,</span> <span class="n">schedule</span><span class="o">);</span>

      <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

      <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
      <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span><span class="c1">//You return this response and work with it</span>

      <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
      <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
      <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
            <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
        <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
            <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Recurring Bill Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span> <span class="c1">//Last resource of the path</span>
          <span class="o">}</span>

        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="o">}</span>


    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span>
</code></pre>
<pre><code class="highlight php"><span class="cp">&lt;?php</span>
  <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

  <span class="c1">//Defining the Web Service URL
</span>  <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"http://payhub.com/payhubws/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


  <span class="c1">//Defining data for the RECURRING BILL transaction
</span>  <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>  <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
  <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>
  <span class="c1">// bill data
</span>  <span class="nv">$base_amount</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
  <span class="nv">$shipping_amount</span> <span class="o">=</span> <span class="mf">1.23</span><span class="p">;</span>
  <span class="nv">$tax_amount</span> <span class="o">=</span> <span class="mf">1.00</span><span class="p">;</span>
  <span class="nv">$note</span> <span class="o">=</span> <span class="s2">"this a sample note"</span><span class="p">;</span>
  <span class="nv">$invoice_number</span> <span class="o">=</span> <span class="s2">"a-00240"</span><span class="p">;</span>
  <span class="nv">$po_number</span> <span class="o">=</span> <span class="s2">"56"</span><span class="p">;</span>
  <span class="c1">//Credit card data
</span>  <span class="nv">$card_number</span> <span class="o">=</span> <span class="s2">"5466410004374507"</span><span class="p">;</span>
  <span class="nv">$card_expiry_date</span> <span class="o">=</span> <span class="s2">"202011"</span><span class="p">;</span>
  <span class="nv">$cvv_data</span> <span class="o">=</span> <span class="s2">"998"</span><span class="p">;</span>
  <span class="nv">$billing_address_1</span> <span class="o">=</span> <span class="s2">"2350 Kerner Blvd"</span><span class="p">;</span>
  <span class="nv">$billing_address_2</span> <span class="o">=</span> <span class="s2">"On the corner"</span><span class="p">;</span>
  <span class="nv">$billing_city</span> <span class="o">=</span> <span class="s2">"San Rafael"</span><span class="p">;</span>
  <span class="nv">$billing_state</span> <span class="o">=</span> <span class="s2">"CA"</span><span class="p">;</span>
  <span class="nv">$billing_zip</span> <span class="o">=</span> <span class="s2">"94901"</span><span class="p">;</span>
  <span class="c1">// Customer data
</span>  <span class="nv">$first_name</span> <span class="o">=</span> <span class="s2">"First"</span><span class="p">;</span>
  <span class="nv">$last_name</span> <span class="o">=</span> <span class="s2">"Contact"</span><span class="p">;</span>
  <span class="nv">$company_name</span> <span class="o">=</span> <span class="s2">"Payhub Inc"</span><span class="p">;</span>
  <span class="nv">$job_title</span> <span class="o">=</span> <span class="s2">"Software Engineer"</span><span class="p">;</span>
  <span class="nv">$email_address</span> <span class="o">=</span> <span class="s2">"jhon@company.com"</span><span class="p">;</span>
  <span class="nv">$web_address</span> <span class="o">=</span> <span class="s2">"http://payhub.com"</span><span class="p">;</span>
  <span class="nv">$phone_number</span> <span class="o">=</span> <span class="s2">"(415) 479 1349"</span><span class="p">;</span>
  <span class="nv">$phone_ext</span> <span class="o">=</span> <span class="s2">"123"</span><span class="p">;</span>
  <span class="nv">$phone_type</span> <span class="o">=</span> <span class="s2">"M"</span><span class="p">;</span>
  <span class="c1">// Schedule data
</span>  <span class="nv">$schedule_type</span> <span class="o">=</span> <span class="s2">"M"</span><span class="p">;</span>
  <span class="nv">$bill_generation_interval</span><span class="o">=</span><span class="s2">"1"</span><span class="p">;</span>
  <span class="c1">//Schedule - schedule_start_and_end (object)
</span>  <span class="nv">$start_date</span><span class="o">=</span><span class="s2">"2015-06-01"</span><span class="p">;</span>
  <span class="nv">$end_date_type</span><span class="o">=</span><span class="s2">"A"</span><span class="p">;</span>
  <span class="nv">$end_after_bill_count</span><span class="o">=</span><span class="s2">"6"</span><span class="p">;</span>
  <span class="c1">//Schedule - monthly_schedule (object)
</span>  <span class="nv">$monthly_type</span><span class="o">=</span><span class="s2">"E"</span><span class="p">;</span>
  <span class="c1">//This is an array, put the elements separated by ","
</span>  <span class="nv">$monthly_each_days</span><span class="o">=</span><span class="s2">"1"</span><span class="p">;</span>

  <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"bill"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"base_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$base_amount</span><span class="p">),</span>
    <span class="s2">"shipping_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$shipping_amount</span><span class="p">),</span>
    <span class="s2">"tax_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$tax_amount</span><span class="p">));</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"card_data"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"card_expiry_date"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_expiry_date</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"cvv_data"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$cvv_data</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_address_1"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_1</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"billing_address_2"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_2</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_city"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_city</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"billing_state"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_state</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_zip"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_zip</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"customer"</span><span class="p">]</span><span class="o">=</span>  <span class="k">array</span><span class="p">(</span><span class="s2">"first_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$first_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$last_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"company_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$company_name</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"job_title"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$job_title</span><span class="s2">"</span><span class="p">,</span><span class="s2">"email_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$email_address</span><span class="s2">"</span><span class="p">,</span><span class="s2">"web_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$web_address</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_ext"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_ext</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_type"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_type</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"schedule"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"schedule_type"</span> <span class="o">=&gt;</span> <span class="nv">$schedule_type</span><span class="p">,</span> <span class="s2">"bill_generation_interval"</span> <span class="o">=&gt;</span> <span class="nv">$bill_generation_interval</span><span class="p">,</span>
    <span class="s2">"schedule_start_and_end"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"start_date"</span> <span class="o">=&gt;</span> <span class="nv">$start_date</span><span class="p">,</span> <span class="s2">"end_date_type"</span> <span class="o">=&gt;</span> <span class="nv">$end_date_type</span><span class="p">,</span> <span class="s2">"end_after_bill_count"</span> <span class="o">=&gt;</span> <span class="nv">$end_after_bill_count</span><span class="p">),</span>
    <span class="s2">"monthly_schedule"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"monthly_type"</span> <span class="o">=&gt;</span> <span class="nv">$monthly_type</span><span class="p">));</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"schedule"</span><span class="p">][</span><span class="s2">"monthly_schedule"</span><span class="p">][</span><span class="s2">"monthly_each_days"</span><span class="p">]</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span><span class="nv">$monthly_each_days</span><span class="p">);</span>

  <span class="c1">//Convert data from Array to JSON
</span>  <span class="k">echo</span> <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

  <span class="c1">//Creating a CURL object to access the WS
</span>  <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
  <span class="c1">//Setting the address to connect to
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
  <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
  <span class="c1">//Setting data in JSON format
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
  <span class="c1">//Setting the proper header.
</span>  <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
    <span class="s1">'Accept: application/json'</span><span class="p">,</span>
    <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="c1">//execute connection to the Web Service
</span>  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
  <span class="c1">// get some data from the response
</span>  <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
  <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
  <span class="c1">//Get the header as string.
</span>  <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
  <span class="c1">//close connection to the Web Service
</span>  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

  <span class="c1">//Obtain the data from the recurring bill recently created
</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
    <span class="c1">//find the url of the recurring bill (Location header in the response)
</span>    <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
    <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>    <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
    <span class="c1">//Setting the proper header.
</span>    <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
    <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">//execute connection to the Web Service
</span>    <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//close connection to the Web Service
</span>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>    <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
    <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>    <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//There was an error with the WS
</span>  <span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<pre><code class="highlight csharp"><span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">PayHubSamples</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">RecurringBilling</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CreateRecurringBilling</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://payhub.com/payhubws/api/v2/recurring-bill"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                <span class="n">var</span> <span class="n">recurringBill</span> <span class="p">=</span> <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                     <span class="p">{</span>
                         <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                         <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                     <span class="p">},</span>
                    <span class="n">bill</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">base_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"1275"</span> <span class="c1">//$12.75
</span>                        <span class="p">},</span>
                        <span class="n">shipping_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"725"</span> <span class="c1">//$7.25
</span>                        <span class="p">},</span>
                        <span class="n">tax_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"113"</span> <span class="c1">//$1.13
</span>                        <span class="p">},</span>
                        <span class="n">note</span> <span class="p">=</span> <span class="s">"Shipped as a gift"</span><span class="p">,</span>
                        <span class="n">invoice_number</span> <span class="p">=</span> <span class="s">"4645782"</span><span class="p">,</span>
                        <span class="n">po_number</span> <span class="p">=</span> <span class="s">"1234-654321"</span>
                    <span class="p">},</span>
                    <span class="n">card_data</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">card_number</span> <span class="p">=</span> <span class="s">"5466410004374507"</span><span class="p">,</span>
                        <span class="n">card_expiry_date</span> <span class="p">=</span> <span class="s">"201809"</span><span class="p">,</span> <span class="c1">//September 2018
</span>                        <span class="n">billing_address_1</span> <span class="p">=</span> <span class="s">"237 E 33rd Street"</span><span class="p">,</span>
                        <span class="n">billing_address_2</span> <span class="p">=</span> <span class="s">"3rd Floor"</span><span class="p">,</span>
                        <span class="n">billing_city</span> <span class="p">=</span> <span class="s">"New York"</span><span class="p">,</span>
                        <span class="n">billing_state</span> <span class="p">=</span> <span class="s">"NY"</span><span class="p">,</span>
                        <span class="n">billing_zip</span> <span class="p">=</span> <span class="s">"10016"</span>
                    <span class="p">},</span>
                    <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">first_name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span>
                        <span class="n">last_name</span> <span class="p">=</span> <span class="s">"Smith"</span><span class="p">,</span>
                        <span class="n">company_name</span> <span class="p">=</span> <span class="s">"CBA Stakehouse"</span><span class="p">,</span>
                        <span class="n">job_title</span> <span class="p">=</span> <span class="s">"Owner"</span><span class="p">,</span>
                        <span class="n">email_address</span> <span class="p">=</span> <span class="s">"john@cbastakehouse.com"</span><span class="p">,</span>
                        <span class="n">web_address</span> <span class="p">=</span> <span class="s">"http://www.cbasteakhouse.com"</span><span class="p">,</span>
                        <span class="n">phone_number</span> <span class="p">=</span> <span class="s">"(917) 479 1349"</span><span class="p">,</span>
                        <span class="n">phone_ext</span> <span class="p">=</span> <span class="s">"5478"</span><span class="p">,</span>
                        <span class="n">phone_type</span> <span class="p">=</span> <span class="s">"M"</span>
                    <span class="p">},</span>
                    <span class="n">schedule</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">schedule_type</span> <span class="p">=</span> <span class="s">"S"</span><span class="p">,</span>
                        <span class="n">specific_dates_schedule</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">specific_dates</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span>
                            <span class="p">{</span>
                                <span class="s">"2016-02-01"</span><span class="p">,</span>
                                <span class="s">"2016-10-31"</span>
                            <span class="p">}</span>
                        <span class="p">}</span>

                    <span class="p">}</span>
                <span class="p">};</span>

                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">recurringBill</span><span class="p">);</span>

                <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                <span class="p">{</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Recurring Billing Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"organization_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
    </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"bill"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">72.34</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"shipping_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.87</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"tax_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">7.23</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gym stuff monthly delivered."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"invoice_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FF7845742ARG"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"po_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"What is a PO number?"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"card_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"card_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4055011111111111"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card_expiry_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"201709"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"154 E 34th St"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fifth Floor"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New York"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10016"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Adam"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"company_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Capital Inc"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"job_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"President"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adam@smith.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"web_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://capitalinc.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(917) 479 1349"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_ext"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5702"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"W"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"schedule_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"S"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"specific_dates_schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"specific_dates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"2015-10-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"2016-09-30"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This topic provides information about the Recurring Bill transaction.</p>

<p>Use the recurring billing transaction when you want to periodically charge certain amount to the customer. You can use this feature for subscriptions or for any ongoing product or service you offer. You can setup a recurring billing by calling our RESTful API through an HTTP post containing a JSON.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">POST</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">http://payhub.com/payhubws/api/recurring-bill</code></p>

<h2 id="elements">Elements</h2>

<h3 id="recurringbillinput">RecurringBillInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>customer</td>
<td>CustomerInput</td>
<td>Customer detail.</td>
</tr>
<tr>
<td>card_data</td>
<td>CardDataInput</td>
<td>Card data to use in the bill.</td>
</tr>
<tr>
<td>merchant</td>
<td>MerchantInput</td>
<td>Merchant detail.</td>
</tr>
<tr>
<td>bill</td>
<td>BillInput</td>
<td>Bill-related data to use in the recurring bill.</td>
</tr>
<tr>
<td>schedule</td>
<td>ScheduleInput</td>
<td>Schedule detail.</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent data in the client&rsquo;s domain that can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="customerinput">CustomerInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>string</td>
<td>The first name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>The last name of the customer.</td>
</tr>
<tr>
<td>company_name</td>
<td>string, optional</td>
<td>The company name of the customer.</td>
</tr>
<tr>
<td>job_title</td>
<td>string, optional</td>
<td>The job title of the customer.</td>
</tr>
<tr>
<td>email_address</td>
<td>string, optional</td>
<td>The email address of the customer. <br>The email address must be syntactically correct. If email address is not specified, you must provide a phone_number to identify the customer.</td>
</tr>
<tr>
<td>web_address</td>
<td>string, optional</td>
<td>The web address of the customer. <br>The web address if specified, must be a syntactically valid web address.</td>
</tr>
<tr>
<td>phone_number</td>
<td>string, optional</td>
<td>The phone number of the customer. <br>The phone number must be syntactically correct. For example: (415) 234 5678, or 4152345678, or (415) 234-5678. <br>If phone number is not specified, you must provide an email_address to identify the customer.</td>
</tr>
<tr>
<td>phone_ext</td>
<td>string, optional</td>
<td>The phone extension number of the customer.</td>
</tr>
<tr>
<td>phone_type</td>
<td>string, optional</td>
<td>The type of the phone number: [&lsquo;H&rsquo; or &#39;W&rsquo; or &rsquo;M&rsquo;]: H (Home), W (Work), M (Mobile).</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent data in the client&rsquo;s domain that can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="metadata">MetaData</h3>

<p>No parameters</p>

<h3 id="carddatainput">CardDataInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>card_expiry_date</td>
<td>string</td>
<td>The card expiry date in YYYYMM format.</td>
</tr>
<tr>
<td>tokenized_card</td>
<td>string, optional</td>
<td>This is a 16 character PayHub-specific tokenized string representing the card number. <br>The value for the given customer and credit card can be obtained by examining the lastRecurringBillResponse.billingReferences.tokenizedCard by accessing the link to the bill that was successfully created. It is safer (and recommended) for the third party client to store and use this string in any future requests for the same customer. <br>This value is required if the &#39;card_number&rsquo; property is not present in the request.</td>
</tr>
<tr>
<td>card_number</td>
<td>string, optional</td>
<td>This is a 16 character card number. <br>This value is required if the &#39;tokenized_card&rsquo; property is not present in the request. <br> <strong>Note:</strong> The card number is not stored by the API in plain text - the response will contain a tokenized card number that should always be used in future requests, (for the same Customer) in place of this property.</td>
</tr>
<tr>
<td>billing_address_1</td>
<td>string, optional</td>
<td>The billing street address of the customer.</td>
</tr>
<tr>
<td>billing_address_2</td>
<td>string, optional</td>
<td>The additional billing street address of the customer.</td>
</tr>
<tr>
<td>billing_city</td>
<td>string, optional</td>
<td>The billing city of the customer.</td>
</tr>
<tr>
<td>billing_state</td>
<td>string, optional</td>
<td>The billing state Code of the customer. The codes are for the states in the USA. For example, CA, WI, NY, etc.</td>
</tr>
<tr>
<td>billing_zip</td>
<td>string, optional</td>
<td>The billing zip code of the customer. The codes are for the states in the USA. <br>The code must be either 5 digits or 5 plus four separated by a &rsquo;-&rsquo;. <br>This value is required if the Merchant has the AVS flag turned on.</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent the data in the client&rsquo;s domain, which can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="merchantinput">MerchantInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The organization Id ([&#39;range[0-]&rsquo;]) of the merchant. <br>This Id must match the organization Id of the merchant that the passed Oauth Token is associated with.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The Virtual Terminal Id ([&#39;range[0-]&rsquo;]) for 3rd Party API of the merchant.</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent data in the client&rsquo;s domain that can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="billinput">BillInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>tax_amount</td>
<td>TransactionAmount, optional</td>
<td>The tax amount for the transaction. <br>This value will be included in the total amount charged.</td>
</tr>
<tr>
<td>po_number</td>
<td>string, optional</td>
<td>The purchase order number for the transaction.</td>
</tr>
<tr>
<td>base_amount</td>
<td>TransactionAmount</td>
<td>The Base amount of the recurring bill. <br> The total amount charged will be the sum of this amount and (any) &#39;shipping_amount&rsquo; and &#39;tax_amount&rsquo;.</td>
</tr>
<tr>
<td>shipping_amount</td>
<td>TransactionAmount, optional</td>
<td>The shipping amount for the transaction. <br>This will be included in the total amount charged.</td>
</tr>
<tr>
<td>invoice_number</td>
<td>string, optional</td>
<td>The invoice number for the transaction.</td>
</tr>
<tr>
<td>note</td>
<td>string, optional</td>
<td>A free format note for the transaction. <br>The note will be read by the Merchant.</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent data in the client&rsquo;s domain, which can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="transactionamount">TransactionAmount</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>Number</td>
<td>The amount expressed as a decimal number with at most two decimal places (example: 1.23),</td>
</tr>
<tr>
<td>currency</td>
<td>string, optional</td>
<td>The ISO 4217 currency code for this amount. <br>[&#39;USD&rsquo;]: Currently only &#39;USD&rsquo; is accepted.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="scheduleinput">ScheduleInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>specific_dates_schedule</td>
<td>SpecificDatesSchedule, optional</td>
<td>Required if the schedule_type is &rsquo;S&rsquo; (=&#39;Specific Dates&rsquo;).</td>
</tr>
<tr>
<td>weekly_schedule</td>
<td>WeeklySchedule, optional</td>
<td>Required if the schedule_type is &#39;W&rsquo; (=&#39;Weekly&rsquo;).</td>
</tr>
<tr>
<td>schedule_type</td>
<td>string</td>
<td>The type of schedule being set up, [&rsquo;M&rsquo; or &rsquo;D&rsquo; or &#39;Y&rsquo; or &#39;W&rsquo; or &rsquo;S&rsquo;]: &rsquo;M&rsquo; (=&#39;Monthly&rsquo;), &rsquo;D&rsquo; (=&#39;Daily&rsquo;), &#39;Y&rsquo; (=&#39;Yearly&rsquo;), &#39;W&rsquo; (=&#39;Weekly&rsquo;), S=Specific Dates.</td>
</tr>
<tr>
<td>bill_generation_interval</td>
<td>integer, optional</td>
<td>The interval between bills where the unit is dependent on the value of the schedule_type (example: if the schedule_type is &#39;W&rsquo; and this field is 3, the bill will recur every three weeks). <br>Applicable to schedule_typeof &rsquo;M&rsquo; (=&#39;Monthly&rsquo;), &rsquo;D&rsquo; (=&#39;Daily&rsquo;), &#39;Y&rsquo; (=&#39;Yearly&rsquo;), and &#39;W&rsquo; (=&#39;Weekly&rsquo;).</td>
</tr>
<tr>
<td>monthly_schedule</td>
<td>MonthlySchedule, optional</td>
<td>Required if the schedule_type is &rsquo;M&rsquo; (=&#39;Monthly&rsquo;).</td>
</tr>
<tr>
<td>schedule_start_and_end</td>
<td>ScheduleStartAndEnd, optional</td>
<td>Required if the schedule_type is not &rsquo;S&rsquo; ( not &#39;Specific Dates&rsquo;).</td>
</tr>
<tr>
<td>yearly_schedule</td>
<td>YearlySchedule, optional</td>
<td>Required if the schedule_type is &#39;Y&rsquo; (=&#39;Yearly&rsquo;).</td>
</tr>
<tr>
<td>metaData</td>
<td>MetaData, optional</td>
<td>A client-specific arbitrary (but valid) JSON string to represent data in the client&rsquo;s domain that can be associated with this entity.</td>
</tr>
</tbody></table>

<h4 id="example">Example</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="err">'order'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">'invoice'</span><span class="p">:</span><span class="err">'a</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'lines'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">1</span><span class="err">'</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="err">'item'</span><span class="p">:</span><span class="w"> </span><span class="err">'part</span><span class="w"> </span><span class="mi">2</span><span class="err">'</span><span class="p">}]}}</span><span class="w">
</span></code></pre>

<h3 id="specificdatesschedule">SpecificDatesSchedule</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>specific_dates</td>
<td>array[string]</td>
<td>An array of specific dates on which the bill should recur. The dates should be in the YYYY-MM-DD format. There must be at least one date specified and all dates must be later than today&rsquo;s date.</td>
</tr>
</tbody></table>

<h3 id="weeklyschedule">WeeklySchedule</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>weekly_bill_days</td>
<td>array[string]</td>
<td>The day(s) of week on which the weekly bill recurs. The array must have at least one entry and each entry must be the first three characters of the day name, as in &#39;SUN&rsquo;, and &#39;SAT&rsquo;.</td>
</tr>
</tbody></table>

<h3 id="monthlyschedule">MonthlySchedule</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>monthly_type</td>
<td>string</td>
<td>[&#39;O&rsquo; or &#39;E&rsquo;]: Determines the day(s) of the month on which the bill will recur. <br>Valid values are &#39;O&rsquo; (=&#39;On the&rsquo; - also specify monthly_on_the_day_of_week_in_month and the monthly_day_of_week) and &#39;E&rsquo; (=&#39;Each&rsquo; - also specify monthly_each_days).</td>
</tr>
<tr>
<td>monthly_each_days</td>
<td>array[integer], optional</td>
<td>An array of integers that must have at least one entry and each entry must be in the range between 1 and 32 where a &#39;1&rsquo; means &#39;first day of month&rsquo;, a &#39;2&rsquo; means &#39;second day of month and so on. An entry of &#39;32&rsquo; means &#39;last day of month&rsquo;. <br>This value is applicable to monthly_type of &#39;E&rsquo; (=&#39;Each&rsquo;).</td>
</tr>
<tr>
<td>monthly_on_the_day_of_week_in_month</td>
<td>integer, optional</td>
<td>A value ([&#39;range[1-5]&rsquo;]) of 1 means &#39;first of month&rsquo;, 2 means &#39;second of month&rsquo; and so on, with a value of 5 meaning &#39;last of month&rsquo;. Must be specified in combination with monthly_day_of_week which supplies the day of week (Monday, Tuesday, etc.) that this applies to. <br>This value is applicable to monthly_type of &#39;O&rsquo; (=&#39;On the&rsquo;).</td>
</tr>
<tr>
<td>monthly_day_of_week</td>
<td>integer, optional</td>
<td>The day of week ([&#39;range[1-7]&rsquo;]) on which the bill recurs, where 1 is Sunday and 7 is Saturday. <br>The value must be specified in combination with monthly_on_the_day_of_week_in_month which supplies the &#39;position&rsquo; (First, Second, etc.) of the day in the month (First Monday, Second Friday, Last Saturday, etc.). <br>This value is applicable to monthly_type of &#39;O&rsquo; (=&#39;On the&rsquo;).</td>
</tr>
</tbody></table>

<h3 id="schedulestartandend">ScheduleStartAndEnd</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>start_date</td>
<td>string, optional</td>
<td>The date to start the schedule in YYYY-MM-DD format. <br>The value is required if the schedule_type is &rsquo;M&rsquo; (=&#39;Monthly&rsquo;), &rsquo;D&rsquo; (=&#39;Daily&rsquo;), or &#39;W&rsquo; (=&#39;Weekly&rsquo;).</td>
</tr>
<tr>
<td>end_date</td>
<td>string, optional</td>
<td>The date to end the schedule in YYYY-MM-DD format. <br>The value is applicable to end_date_type equal to &#39;O&rsquo; (=&#39;End On date&rsquo;).</td>
</tr>
<tr>
<td>end_date_type</td>
<td>string, optional</td>
<td>Determines the date on which the schedule ends. <br>The values ([&#39;N&rsquo; or &rsquo; A&rsquo; or &rsquo; O&rsquo;]:) can be &#39;N&rsquo; (=&#39;Never&rsquo;), &#39;A&rsquo; (=&#39;After a number of bills&rsquo; - you must also specify a end_after_bill_count), or &#39;O&rsquo; (=&#39;On or no later than a specific date&rsquo; - you must also specify a end_date). If not present, then &#39;N&rsquo; (=&#39;Never&rsquo;) is assumed.</td>
</tr>
<tr>
<td>end_after_bill_count</td>
<td>integer, optional</td>
<td>The number of bills before ending the schedule. Applicable to end_date_type equal to &#39;A&rsquo; (=&#39;After a number of bills&rsquo;).</td>
</tr>
</tbody></table>

<h3 id="yearlyschedule">YearlySchedule</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>year_to_start</td>
<td>string</td>
<td>The year (in YYYY format) in which the schedule starts. <br>You must also specify yearly_bill_on_month_number and yearly_bill_on_day_of_month.</td>
</tr>
<tr>
<td>yearly_bill_on_day_of_month</td>
<td>integer</td>
<td>The month number ( [&#39;range[1-12]&rsquo;]) on which the bill will recur, where 1 is January and 12 is December. Must be specified in combination with year_to_start and yearly_bill_on_day_of_month.</td>
</tr>
<tr>
<td>yearly_bill_on_day_of_month</td>
<td>string</td>
<td>The day of the month ([&#39;range[1-31]&rsquo;]) on which the yearly bill will recur, where 1 is the 1st, 2 is the 2nd, etc. <br>If you specify a day of month that is invalid for the month specified by yearly_bill_on_month_number, then the last day of the month is used. Must be specified in combination with year_to_start and yearly_bill_on_month_number.</td>
</tr>
</tbody></table>

<h2 id="example-of-json-code">Example of JSON code</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
 </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">  
 </span><span class="p">},</span><span class="w">


</span><span class="s2">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="s2">"base_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">72.34</span><span class="w">
 </span><span class="p">},</span><span class="w">
</span><span class="s2">"shipping_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.87</span><span class="w">
 </span><span class="p">},</span><span class="w">
</span><span class="s2">"tax_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

 </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">7.23</span><span class="w">
 </span><span class="p">},</span><span class="w">
</span><span class="s2">"note"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Gym stuff monthly delivered."</span><span class="p">,</span><span class="w">

 </span><span class="s2">"invoice_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"FF7845742ARG"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"po_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"What is a PO number?"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"card_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="s2">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"4055011111111111"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"card_expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"201709"</span><span class="p">,</span><span class="w">

 </span><span class="s2">"billing_address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"154 E 34th St"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"billing_address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Fifth Floor"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"billing_city"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"New York"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"billing_state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"billing_zip"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"10016"</span><span class="w">

 </span><span class="p">},</span><span class="w">
 </span><span class="s2">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"first_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Adam"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"last_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"company_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Capital Inc"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"President"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"email_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"adam@smith.com"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"web_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://capitalinc.com"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"phone_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"(917) 479 1349"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"phone_ext"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5702"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"phone_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"W"</span><span class="w">

 </span><span class="p">},</span><span class="w">
 </span><span class="s2">"schedule"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"schedule_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"S"</span><span class="p">,</span><span class="w">

 </span><span class="s2">"specific_dates_schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"specific_dates"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"2015-10-01"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2016-09-30"</span><span class="w"> </span><span class="p">]</span><span class="w">
 </span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="response-messages">Response Messages</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Meaning</th>
<th>Sample code</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>(not returned)</td>
<td><code class="prettyprint">ResourceSupport { links (array[Link], optional) } Link { templated (boolean, optional), rel (string, optional), href (string, optional) }</code></td>
</tr>
<tr>
<td>201</td>
<td>The recurring bill was created - use the link in the response&rsquo;s &#39;Location&rsquo; Header to view the Recurring Bill.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>400</td>
<td>Bad request due to incorrect or invalid data passed.</td>
<td><code class="prettyprint">RestErrorStructure { errors ( array[RestError], optional)} RestError {   status ( string, optional) = [&#39;100&#39; or &#39;101&#39; or &#39;102&#39; or &#39;103&#39; or &#39;200&#39; or &#39;201&#39; or &#39;202&#39; or &#39;203&#39; or &#39;204&#39; or &#39;205&#39; or &#39;206&#39; or &#39;207&#39; or &#39;208&#39; or &#39;226&#39; or &#39;300&#39; or &#39;301&#39; or &#39;302&#39; or &#39;302&#39; or &#39;303&#39; or &#39;304&#39; or &#39;305&#39; or &#39;307&#39; or &#39;308&#39; or &#39;400&#39; or &#39;401&#39; or &#39;402&#39; or &#39;403&#39; or &#39;404&#39; or &#39;405&#39; or &#39;406&#39; or &#39;407&#39; or &#39;408&#39; or &#39;409&#39; or &#39;410&#39; or &#39;411&#39; or &#39;412&#39; or &#39;413&#39; or &#39;414&#39; or &#39;415&#39; or &#39;416&#39; or &#39;417&#39; or &#39;418&#39; or &#39;419&#39; or &#39;420&#39; or &#39;421&#39; or &#39;422&#39; or &#39;423&#39; or &#39;424&#39; or &#39;426&#39; or &#39;428&#39; or &#39;429&#39; or &#39;431&#39; or &#39;500&#39; or &#39;501&#39; or &#39;502&#39; or &#39;503&#39; or &#39;504&#39; or &#39;505&#39; or &#39;506&#39; or &#39;507&#39; or &#39;508&#39; or &#39;509&#39; or &#39;510&#39; or &#39;511&#39;]: The Http Status Code, code ( string, optional), location ( string, optional), reason ( string, optional), severity ( string, optional) }</code></td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized. You do not have permission to perform this operation. Make sure you entered a valid API Key at the top of the page.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>403</td>
<td>Forbidden. The server does not permit you to use this URI.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>500</td>
<td>Internal server error due to encoding the data, or to a PayHub server failure. Contact PayHub.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
</tbody></table>

<h2 id="get">Get</h2>

<p>You can also send a GET  to http://payhub.com/payhubws/api/recurring-bill to list all recurring bills and associated operations in compact form.</p>

<p>The response will look like:</p>
<pre><code class="highlight plaintext">Resources«object» {
content (Collection«object», optional),
links (array[Link], optional)
}
Collection«object» {
empty (boolean, optional)
}
Link {
templated (boolean, optional),
rel (string, optional),
href (string, optional)
}
</code></pre>

          <h1 id="sale-transaction">Sale Transaction</h1>
<pre><code class="highlight java"><span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sale</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">RunSale</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
      <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
      <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://payhub.com/payhubws/api/v2/sale"</span><span class="o">;</span>

      <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span><span class="c1">//You put your org id here</span>
        <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">JSONObject</span> <span class="n">base_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">base_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"1275"</span><span class="o">);</span><span class="c1">//$12.75</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"base_amount"</span><span class="o">,</span> <span class="n">base_amount</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">shipping_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">shipping_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"725"</span><span class="o">);</span><span class="c1">//$7.25</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"shipping_amount"</span><span class="o">,</span> <span class="n">shipping_amount</span><span class="o">);</span>
        <span class="n">JSONObject</span> <span class="n">tax_amount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
          <span class="n">tax_amount</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="s">"113"</span><span class="o">);</span><span class="c1">//$1.13</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"tax_amount"</span><span class="o">,</span> <span class="n">tax_amount</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"note"</span><span class="o">,</span> <span class="s">"Shipped as a gift"</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"invoice_number"</span><span class="o">,</span> <span class="s">"4645782"</span><span class="o">);</span>
        <span class="n">bill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"po_number"</span><span class="o">,</span> <span class="s">"1234-654321"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"bill"</span><span class="o">,</span> <span class="n">bill</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">card_data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_number"</span><span class="o">,</span> <span class="s">"5466410004374507"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_expiry_date"</span><span class="o">,</span> <span class="s">"201809"</span><span class="o">);</span><span class="c1">// September 2018</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_1"</span><span class="o">,</span> <span class="s">"237 E 33rd Street"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_address_2"</span><span class="o">,</span> <span class="s">"3rd Floor"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_city"</span><span class="o">,</span> <span class="s">"New York"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_zip"</span><span class="o">,</span> <span class="s">"10016"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"billing_state"</span><span class="o">,</span> <span class="s">"NY"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cvv_data"</span><span class="o">,</span> <span class="s">"998"</span><span class="o">);</span>
        <span class="n">card_data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cvv_code"</span><span class="o">,</span> <span class="s">"Y"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card_data"</span><span class="o">,</span> <span class="n">card_data</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"first_name"</span><span class="o">,</span> <span class="s">"John"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"last_name"</span><span class="o">,</span> <span class="s">"Smith"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"company_name"</span><span class="o">,</span> <span class="s">"CBA Steakhouse"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"job_title"</span><span class="o">,</span> <span class="s">"Owner"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email_address"</span><span class="o">,</span> <span class="s">"john@cbasteakhouse.com"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"web_address"</span><span class="o">,</span> <span class="s">"http://www.cbasteakhouse.com"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_number"</span><span class="o">,</span> <span class="s">"(917) 479 1349"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_ext"</span><span class="o">,</span> <span class="s">"5478"</span><span class="o">);</span>
        <span class="n">customer</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone_type"</span><span class="o">,</span> <span class="s">"M"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="n">customer</span><span class="o">);</span>

      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"record_format"</span><span class="o">,</span> <span class="s">"CC"</span><span class="o">);</span>

      <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

      <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
      <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span> <span class="c1">//You return this response and work with it</span>

      <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
      <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
      <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
            <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
        <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
            <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Transaction Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span> <span class="c1">//Last resource of the path</span>
          <span class="o">}</span>

        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="o">}</span>


    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span>
</code></pre>
<pre><code class="highlight php"><span class="cp">&lt;?php</span>
  <span class="nv">$trans_type</span> <span class="o">=</span> <span class="s2">"sale"</span><span class="p">;</span>
  <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

  <span class="c1">//Defining the Web Service URL
</span>  <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"http://payhub.com/payhubws/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


  <span class="c1">//Defining data for the SALE transaction
</span>  <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>  <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
  <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>
  <span class="c1">// bill data
</span>  <span class="nv">$base_amount</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
  <span class="nv">$shipping_amount</span> <span class="o">=</span> <span class="mf">1.23</span><span class="p">;</span>
  <span class="nv">$tax_amount</span> <span class="o">=</span> <span class="mf">1.00</span><span class="p">;</span>
  <span class="nv">$note</span> <span class="o">=</span> <span class="s2">"this a sample note"</span><span class="p">;</span>
  <span class="nv">$invoice_number</span> <span class="o">=</span> <span class="s2">"a-00240"</span><span class="p">;</span>
  <span class="nv">$po_number</span> <span class="o">=</span> <span class="s2">"56"</span><span class="p">;</span>
  <span class="c1">//Credit card data
</span>  <span class="nv">$card_number</span> <span class="o">=</span> <span class="s2">"5466410004374507"</span><span class="p">;</span>
  <span class="nv">$card_expiry_date</span> <span class="o">=</span> <span class="s2">"202011"</span><span class="p">;</span>
  <span class="nv">$cvv_data</span> <span class="o">=</span> <span class="s2">"998"</span><span class="p">;</span>
  <span class="nv">$billing_address_1</span> <span class="o">=</span> <span class="s2">"2350 Kerner Blvd"</span><span class="p">;</span>
  <span class="nv">$billing_address_2</span> <span class="o">=</span> <span class="s2">"On the corner"</span><span class="p">;</span>
  <span class="nv">$billing_city</span> <span class="o">=</span> <span class="s2">"San Rafael"</span><span class="p">;</span>
  <span class="nv">$billing_state</span> <span class="o">=</span> <span class="s2">"CA"</span><span class="p">;</span>
  <span class="nv">$billing_zip</span> <span class="o">=</span> <span class="s2">"94901"</span><span class="p">;</span>
  <span class="c1">// Customer data
</span>  <span class="nv">$first_name</span> <span class="o">=</span> <span class="s2">"First"</span><span class="p">;</span>
  <span class="nv">$last_name</span> <span class="o">=</span> <span class="s2">"Contact"</span><span class="p">;</span>
  <span class="nv">$company_name</span> <span class="o">=</span> <span class="s2">"Payhub Inc"</span><span class="p">;</span>
  <span class="nv">$job_title</span> <span class="o">=</span> <span class="s2">"Software Engineer"</span><span class="p">;</span>
  <span class="nv">$email_address</span> <span class="o">=</span> <span class="s2">"jhon@company.com"</span><span class="p">;</span>
  <span class="nv">$web_address</span> <span class="o">=</span> <span class="s2">"http://payhub.com"</span><span class="p">;</span>
  <span class="nv">$phone_number</span> <span class="o">=</span> <span class="s2">"(415) 479 1349"</span><span class="p">;</span>
  <span class="nv">$phone_ext</span> <span class="o">=</span> <span class="s2">"123"</span><span class="p">;</span>
  <span class="nv">$phone_type</span> <span class="o">=</span> <span class="s2">"M"</span><span class="p">;</span>


  <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"bill"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"base_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$base_amount</span><span class="p">),</span>
    <span class="s2">"shipping_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$shipping_amount</span><span class="p">),</span>
    <span class="s2">"tax_amount"</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span><span class="p">,</span><span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="nv">$tax_amount</span><span class="p">));</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"card_data"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"card_expiry_date"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$card_expiry_date</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"cvv_data"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$cvv_data</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_address_1"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_1</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"billing_address_2"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_address_2</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_city"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_city</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"billing_state"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_state</span><span class="s2">"</span><span class="p">,</span><span class="s2">"billing_zip"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$billing_zip</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span> <span class="p">[</span><span class="s2">"customer"</span><span class="p">]</span><span class="o">=</span>  <span class="k">array</span><span class="p">(</span><span class="s2">"first_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$first_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$last_name</span><span class="s2">"</span><span class="p">,</span><span class="s2">"company_name"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$company_name</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"job_title"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$job_title</span><span class="s2">"</span><span class="p">,</span><span class="s2">"email_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$email_address</span><span class="s2">"</span><span class="p">,</span><span class="s2">"web_address"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$web_address</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_number</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_ext"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_ext</span><span class="s2">"</span><span class="p">,</span><span class="s2">"phone_type"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$phone_type</span><span class="s2">"</span><span class="p">);</span>

  <span class="c1">//Convert data from Array to JSON
</span>  <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

  <span class="c1">//Creating a CURL object to access the WS
</span>  <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
  <span class="c1">//Setting the address to connect to
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
  <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
  <span class="c1">//Setting data in JSON format
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
  <span class="c1">//Setting the proper header.
</span>  <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
    <span class="s1">'Accept: application/json'</span><span class="p">,</span>
    <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="c1">//execute connection to the Web Service
</span>  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
  <span class="c1">// get some data from the response
</span>  <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
  <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
  <span class="c1">//Get the header as string.
</span>  <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
  <span class="c1">//close connection to the Web Service
</span>  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

  <span class="c1">//Obtain the data from the sale recently created
</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
    <span class="c1">//find the url of the sale (Location header in the response)
</span>    <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
    <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>    <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
    <span class="c1">//Setting the proper header.
</span>    <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
    <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">//execute connection to the Web Service
</span>    <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//close connection to the Web Service
</span>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>    <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
    <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>    <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//There was an error with the WS
</span>  <span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>
<pre><code class="highlight csharp"><span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">PayHubSamples</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Sale</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunSale</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://payhub.com/payhubws/api/v2/sale"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                <span class="n">var</span> <span class="n">sale</span> <span class="p">=</span> <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                     <span class="p">{</span>
                         <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                         <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                     <span class="p">},</span>
                    <span class="n">bill</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">base_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"1275"</span> <span class="c1">//$12.75
</span>                        <span class="p">},</span>
                        <span class="n">shipping_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"725"</span> <span class="c1">//$7.25
</span>                        <span class="p">},</span>
                        <span class="n">tax_amount</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                            <span class="n">amount</span> <span class="p">=</span> <span class="s">"113"</span> <span class="c1">//$1.13
</span>                        <span class="p">},</span>
                        <span class="n">note</span> <span class="p">=</span> <span class="s">"Shipped as a gift"</span><span class="p">,</span>
                        <span class="n">invoice_number</span> <span class="p">=</span> <span class="s">"4645782"</span><span class="p">,</span>
                        <span class="n">po_number</span> <span class="p">=</span> <span class="s">"1234-654321"</span>
                    <span class="p">},</span>
                    <span class="n">card_data</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">card_number</span> <span class="p">=</span> <span class="s">"5466410004374507"</span><span class="p">,</span>
                        <span class="n">card_expiry_date</span> <span class="p">=</span> <span class="s">"201809"</span><span class="p">,</span> <span class="c1">//September 2018
</span>                        <span class="n">billing_address_1</span> <span class="p">=</span> <span class="s">"237 E 33rd Street"</span><span class="p">,</span>
                        <span class="n">billing_address_2</span> <span class="p">=</span> <span class="s">"3rd Floor"</span><span class="p">,</span>
                        <span class="n">billing_city</span> <span class="p">=</span> <span class="s">"New York"</span><span class="p">,</span>
                        <span class="n">billing_state</span> <span class="p">=</span> <span class="s">"NY"</span><span class="p">,</span>
                        <span class="n">billing_zip</span> <span class="p">=</span> <span class="s">"10016"</span><span class="p">,</span>
                        <span class="n">cvv_data</span> <span class="p">=</span> <span class="s">"998"</span><span class="p">,</span>
                        <span class="n">cvv_code</span> <span class="p">=</span> <span class="s">"Y"</span>
                    <span class="p">},</span>
                    <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">first_name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span>
                        <span class="n">last_name</span> <span class="p">=</span> <span class="s">"Smith"</span><span class="p">,</span>
                        <span class="n">company_name</span> <span class="p">=</span> <span class="s">"CBA Stakehouse"</span><span class="p">,</span>
                        <span class="n">job_title</span> <span class="p">=</span> <span class="s">"Owner"</span><span class="p">,</span>
                        <span class="n">email_address</span> <span class="p">=</span> <span class="s">"john@cbastakehouse.com"</span><span class="p">,</span>
                        <span class="n">web_address</span> <span class="p">=</span> <span class="s">"http://www.cbasteakhouse.com"</span><span class="p">,</span>
                        <span class="n">phone_number</span> <span class="p">=</span> <span class="s">"(917) 479 1349"</span><span class="p">,</span>
                        <span class="n">phone_ext</span> <span class="p">=</span> <span class="s">"5478"</span><span class="p">,</span>
                        <span class="n">phone_type</span> <span class="p">=</span> <span class="s">"M"</span>
                    <span class="p">},</span>
                    <span class="n">record_format</span> <span class="p">=</span> <span class="s">"CC"</span>
                <span class="p">};</span>

                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">sale</span><span class="p">);</span>

                <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                <span class="p">{</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Transaction Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"organization_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10002</span><span class="p">,</span><span class="w">
    </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"bill"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"shipping_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.23</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"tax_amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.00</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a note."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"invoice_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"328"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"po_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample po number"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"card_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"card_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5466410004374507"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card_expiry_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202011"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2350 Kerner Blvd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 floor"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Rafael"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94901"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvv_data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"998"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Miguel"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"company_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Payhub Inc"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"job_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Software Engineer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"msmith14567@payhub.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"web_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://payhub.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 479 1349"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_ext"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This topic provides the information about the Sale transaction. Use a Sale transaction to charge a credit card.</p>

<p>Upon successful sale, you will receive an approval code. Once a sale transaction is settled, the money will be taken from the card holder&rsquo;s account and deposited to the merchant&rsquo;s account. This is the most common transaction type.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">POST</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">POST http://payhub.com/payhubws/api/sale</code></p>

<h2 id="elements">Elements</h2>

<h3 id="merchant">merchant</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The Organization Id of the Merchant. This must match the Organization Id of the Merchant that the passed Oauth Token is associated with.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The Merchant&rsquo;s Virtual Terminal Id for 3rd Party API.</td>
</tr>
<tr>
<td>record_format</td>
<td>string, optional</td>
<td>To specify if the sale has to be made over a credit card, debit card or cash payment. If it´s not present, default value &ldquo;CREDIT_CARD&rdquo; is assumed. <br>Accepted values are: <ul><li>CASH_PAYMENT</li><li>CREDIT_CARD</li><li>DEBIT_CARD</li></ul></td>
</tr>
</tbody></table>

<h3 id="customer">customer</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>string</td>
<td>The first name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>The last name of the customer.</td>
</tr>
<tr>
<td>company_name</td>
<td>string, optional</td>
<td>The company name of the customer.</td>
</tr>
<tr>
<td>job_title</td>
<td>string, optional</td>
<td>The job title of the customer.</td>
</tr>
<tr>
<td>email_address</td>
<td>string, optional</td>
<td>The valid email address of the customer. The email address must be syntactically correct. If you do not specify the email address, you must provide a phone_number to identify the customer.</td>
</tr>
<tr>
<td>web_address</td>
<td>string, optional</td>
<td>The web address of the customer. The web address, if you specify, must be syntactically valid web address.</td>
</tr>
<tr>
<td>phone_number</td>
<td>string, optional</td>
<td>The phone number of the customer. The phone number must be syntactically correct. <br>For example, (415) 234 5678, or 4152345678, or (415) 234-5678. <br>If you do not specify the phone number, you must provide an email_address to identify the customer.</td>
</tr>
<tr>
<td>phone_ext</td>
<td>string, optional</td>
<td>The phone extension number of the customer.</td>
</tr>
<tr>
<td>phone_type</td>
<td>string, optional</td>
<td>The type ([&lsquo;H&rsquo; or &#39;W&rsquo; or &rsquo;M&rsquo;]) of the phone number: H (Home), W (Work), M (Mobile).</td>
</tr>
</tbody></table>

<h3 id="card_data">card_data</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>tokenized_card</td>
<td>string, optional</td>
<td>This is the 16 character PayHub-specific tokenized string representing the card number. <br>The value for the given customer and credit card can be obtained by examining the last Sale by accessing the link to the card data that was successfully created. It is safer (and recommended) for the third party client to store and use this string in any future requests for the same customer.</td>
</tr>
<tr>
<td>card_number</td>
<td>string, optional</td>
<td>This is the 16 character card number. <br> The card number is not stored by the API in plain text. The response will contain a tokenized card number that should always be used in future requests, (for the same Customer) in place of this property.</td>
</tr>
<tr>
<td>track1_data</td>
<td>string, optional</td>
<td>This is the string read by the swiper (It contents track 1 data without sentinels).</td>
</tr>
<tr>
<td>track2_data</td>
<td>string, optional</td>
<td>This is the string read by the swiper (It contents track 2 data without sentinels).</td>
</tr>
<tr>
<td>encrypted_track_data</td>
<td>Optional</td>
<td><ul><li><strong>encrypted_track</strong> (string, optional): This is the string read by the swiper. This string contains the encrypted track data. </li><li><strong>swiper_brand</strong> (string, optional): The swiper brand&rsquo;s name with capital letters. Default value is <strong>IDTECH</strong>.</li><li><strong>swiper_model</strong> (string, optional): The swiper model with capital letters. Default value is <strong>UNIMAGII</strong>.</li></ul></td>
</tr>
<tr>
<td>billing_address_1</td>
<td>string, optional</td>
<td>The billing street address of the customer.</td>
</tr>
<tr>
<td>billing_address_2</td>
<td>string, optional</td>
<td>The additional billing street address of the customer.</td>
</tr>
<tr>
<td>billing_city</td>
<td>string, optional</td>
<td>The billing city of the customer.</td>
</tr>
<tr>
<td>billing_state</td>
<td>string, optional</td>
<td>The billing state Code of the customer. <br>For example, CA, WI, NY, etc. <br>The sate codes should be for the states in the USA.</td>
</tr>
<tr>
<td>billing_zip</td>
<td>string, optional</td>
<td>The billing Zip Code of the customer. <br>The zip code must be either 5 digits or 5 plus four separated by a &rsquo;-&rsquo;. <br>The zip code is required if the merchant has turned ON the AVS flag.</td>
</tr>
<tr>
<td>card_expiry_date</td>
<td>string</td>
<td>The card expiry date in the <em>YYYYMM</em> format.</td>
</tr>
<tr>
<td>cvv_data</td>
<td>string</td>
<td>This is the three or four digit CVV code at the back side of the credit and debit card.</td>
</tr>
</tbody></table>

<h3 id="bill">bill</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>base_amount</td>
<td>TransactionAmount</td>
<td>The base amount of the recurring bill. <br>The total amount charged will be the sum of this amount and (any) &#39;shipping_amount&rsquo; and &#39;tax_amount&rsquo;.</td>
</tr>
<tr>
<td>shipping_amount</td>
<td>TransactionAmount, optional</td>
<td>The shipping amount for the transaction. <br>This value will be included in the total amount charged.</td>
</tr>
<tr>
<td>tax_amount</td>
<td>TransactionAmount, optional</td>
<td>The tax amount for the transaction. <br>This value will be included in the total amount charged.</td>
</tr>
<tr>
<td>invoice_number</td>
<td>string, optional</td>
<td>The invoice number for the transaction.</td>
</tr>
<tr>
<td>po_number</td>
<td>string, optional</td>
<td>The purchase order number for the transaction.</td>
</tr>
<tr>
<td>note</td>
<td>string, optional</td>
<td>A free format note for the transaction. The note will be read by the merchant.</td>
</tr>
</tbody></table>

<p><strong>Note:</strong> One of the following fields must be present: <ul><li>tokenized_card</li><li>card_number</li><li>track1_data</li><li>track2_data</li><li>encrypted_track_data</li></ul></p>

<h2 id="example-of-jason">Example of JASON</h2>

<p><code class="prettyprint">{
  &quot;merchant&quot;: {
    &quot;organization_id&quot;: 10002,
    &quot;terminal_id&quot;: 2
  },
  &quot;bill&quot;: {
    &quot;base_amount&quot;: {
      &quot;amount&quot;: 10.0
    },
    &quot;shipping_amount&quot;: {
      &quot;amount&quot;: 1.23
    },
    &quot;tax_amount&quot;: {
      &quot;amount&quot;: 1.00
    },
    &quot;note&quot;: &quot;This is a note.&quot;,
    &quot;invoice_number&quot;: &quot;328&quot;,
    &quot;po_number&quot;: &quot;sample po number&quot;
  },
  &quot;card_data&quot;: {
    &quot;card_number&quot;: &quot;5466410004374507&quot;,
    &quot;card_expiry_date&quot;: &quot;202011&quot;,
    &quot;billing_address_1&quot;: &quot;2350 Kerner Blvd&quot;,
    &quot;billing_address_2&quot;: &quot;2 floor&quot;,
    &quot;billing_city&quot;: &quot;San Rafael&quot;,
    &quot;billing_state&quot;: &quot;CA&quot;,
    &quot;billing_zip&quot;: &quot;94901&quot;,
    &quot;cvv_data&quot;: &quot;998&quot;
  },
  &quot;customer&quot;: {
    &quot;first_name&quot;: &quot;Miguel&quot;,
    &quot;last_name&quot;: &quot;Smith&quot;,
    &quot;company_name&quot;: &quot;Payhub Inc&quot;,
    &quot;job_title&quot;: &quot;Software Engineer&quot;,
    &quot;email_address&quot;: &quot;msmith14567@payhub.com&quot;,
    &quot;web_address&quot;: &quot;http://payhub.com&quot;,
    &quot;phone_number&quot;: &quot;(415) 479 1349&quot;,
    &quot;phone_ext&quot;: &quot;123&quot;,
    &quot;phone_type&quot;: &quot;M&quot;
  }
}
</code></p>

<h2 id="result">Result</h2>

<ul>
<li>A 201 code (created)</li>
<li>The Id of the Sale in the Location header.
<br>Sample header in the response: <code class="prettyprint">Location → http:// [payhub-api-server]:8251/payhubws/api/sale/5501b651da06a879ce520d4d</code>.
<br>If you do a GET request to this URL, you will get all the transaction information in JSON format.</li>
</ul>

<h2 id="sample-response">Sample Response</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-19T12:58:09.863-03:00"</span><span class="p">,</span><span class="w">
</span><span class="s2">"lastModified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-19T12:58:09.863-03:00"</span><span class="p">,</span><span class="w">
</span><span class="s2">"createdBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10002"</span><span class="p">,</span><span class="w">
</span><span class="s2">"lastModifiedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10002"</span><span class="p">,</span><span class="w">
</span><span class="s2">"metaData"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"record_format"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"settlementStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Not settled"</span><span class="p">,</span><span class="w">
</span><span class="s2">"saleResponse"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"saleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"478"</span><span class="p">,</span><span class="w">
</span><span class="s2">"approvalCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VTLMC1"</span><span class="p">,</span><span class="w">
</span><span class="s2">"processedDateTime"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"avsResultCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N"</span><span class="p">,</span><span class="w">
</span><span class="s2">"verificationResultCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
</span><span class="s2">"batchId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"38"</span><span class="p">,</span><span class="w">
</span><span class="s2">"responseCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00"</span><span class="p">,</span><span class="w">
</span><span class="s2">"responseText"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
</span><span class="s2">"cisNote"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
</span><span class="s2">"riskStatusResponseText"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
</span><span class="s2">"riskStatusRespondeCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
</span><span class="s2">"saleDateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-19 12:58:09"</span><span class="p">,</span><span class="w">
</span><span class="s2">"tokenizedCard"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerReference"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"customerId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerEmail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"msmith14567@payhub.com"</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerPhones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="p">},</span><span class="w">

</span><span class="s2">"billingReferences"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"cardObscured"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"tokenizedCard"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9999000000001804"</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerCardId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="s2">"customerBillId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">},</span><span class="w">
</span><span class="s2">"_links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dc1-api.payhub.com/payhubws/api/v2/sale/478"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dc1-api.payhub.com/payhubws/api/v2/sale/478/merchant"</span><span class="w">

</span><span class="p">},</span><span class="w">
</span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dc1-api.payhub.com/payhubws/api/v2/sale/478/customer"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"card_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dc1-api.payhub.com/payhubws/api/v2/sale/478/card_data"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"bill"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dc1-api.payhub.com/payhubws/api/v2/sale/478/bill"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>On the same way you  can query about merchant, customer, bill and card data details using the given URLs.</p>

<p><strong>Note:</strong> You will need to use the Oauth token in the header request for sales or any other transaction. For more information, see the OAUTH section.</p>

          <h2 id="void-transaction">Void Transaction</h2>
<pre><code class="highlight java"><span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Void</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">RunVoid</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
      <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
      <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://payhub.com/payhubws/api/v2/void"</span><span class="o">;</span>

      <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span> <span class="c1">//You put your org id here</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>

      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"transaction_id"</span><span class="o">,</span> <span class="s">"223"</span><span class="o">);</span> <span class="c1">//You put the transaction id of the sale or refund you want to void</span>

      <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

      <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
      <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span> <span class="c1">//You return this response and work with it</span>

      <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
      <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
      <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
            <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
        <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
            <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Transaction Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span>
          <span class="o">}</span>

        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="o">}</span>


    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>


<span class="o">}</span>
</code></pre>
<pre><code class="highlight php"><span class="cp">&lt;?php</span>
  <span class="nv">$trans_type</span> <span class="o">=</span> <span class="s2">"void"</span><span class="p">;</span>
  <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

  <span class="c1">//Defining the Web Service URL
</span>  <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"http://payhub.com/payhubws/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


  <span class="c1">//Defining data for the VOID transaction
</span>  <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>  <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
  <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>
  <span class="nv">$transaction_id</span><span class="o">=</span><span class="s2">"83"</span><span class="p">;</span>



  <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"transaction_id"</span><span class="p">]</span><span class="o">=</span><span class="nv">$transaction_id</span><span class="p">;</span>

  <span class="c1">//Convert data from Array to JSON
</span>  <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

  <span class="c1">//Creating a CURL object to access the WS
</span>  <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
  <span class="c1">//Setting the address to connect to
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
  <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
  <span class="c1">//Setting data in JSON format
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
  <span class="c1">//Setting the proper header.
</span>  <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
    <span class="s1">'Accept: application/json'</span><span class="p">,</span>
    <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="c1">//execute connection to the Web Service
</span>  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
  <span class="c1">// get some data from the response
</span>  <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
  <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
  <span class="c1">//Get the header as string.
</span>  <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
  <span class="c1">//close connection to the Web Service
</span>  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

  <span class="c1">//Obtain the data from the void recently created
</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
    <span class="c1">//find the url of the void (Location header in the response)
</span>    <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
    <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>    <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
    <span class="c1">//Setting the proper header.
</span>    <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
    <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">//execute connection to the Web Service
</span>    <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//close connection to the Web Service
</span>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>    <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
    <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>    <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//There was an error with the WS
</span>  <span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>
<pre><code class="highlight csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">PayHubSamples</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Void</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunVoid</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://payhub.com/payhubws/api/v2/void"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                <span class="n">var</span> <span class="n">refund</span> <span class="p">=</span> <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                    <span class="p">{</span>
                        <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                        <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="n">transaction_id</span> <span class="p">=</span> <span class="s">"238"</span>
                <span class="p">};</span>

                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">refund</span><span class="p">);</span>

                <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                <span class="p">{</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Transaction Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"organization_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
    </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"114"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h1 id="void-transaction">Void Transaction</h1>

<p>Run a Void when you need to cancel a transaction (either a sale or a refund) that has not yet been settled and that has not already been voided. This will avoid the customer being charged any amount at all and will release the pending funds, given the issuer supports doing so.</p>

<h2 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h2>

<p><code class="prettyprint">POST http://payhub.com/payhubws/api/void</code></p>

<h2 id="elements-(all-required)">Elements (All required)</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The merchant&rsquo;s organization id which did the sale you&rsquo;re trying to void.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The merchant&rsquo;s terminal&rsquo;s id where the sale was done.</td>
</tr>
<tr>
<td>transaction_id</td>
<td>integer</td>
<td>The transaction id of the sale that you want to void.</td>
</tr>
</tbody></table>

<h2 id="example-of-json">Example of JSON</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
 </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">

 </span><span class="p">},</span><span class="w">

 </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"114"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="authonly-transaction">AuthOnly Transaction</h1>

<p>This topic provides the information about the <strong>AuthOnly</strong> transaction.</p>

<p>You can use the AuthOnly transaction to authorize an amount on your customer&rsquo;s credit card without making the actual settlement of that amount. With the AuthOnly transaction, you actually reserve an amount for a certain period against the credit limit of the card holder.</p>

<p>Usually, you use the AutOnly transaction type when you are selling an item, which is currently out of stock. So, you run the AuthOnly transaction when the item is not available and when the item becomes available in the stock, you run the Capture transaction to actually make the settlement for the reserved amount. To simply say, the AuthOnly and Capture transactions are essentially a sale process in two steps.</p>

<p>The sale is considered complete when you successfully complete both the Capture and AuthOnly transactions. The money will be debited from the card holder’s account and credited to your account after the sale is complete.</p>

<p>When the AuthOnly transaction is successfully executed, you will receive a 201 Created code on a successful AuthOnly. This code also includes the transaction ID. You can use this transaction ID to run the Capture transaction.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">POST</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">POST http://payhub.com/payhubws/api/v2/authOnly</code></p>

<h2 id="elements">Elements</h2>

<h3 id="merchant">merchant</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The Organization Id of the Merchant. <br>This value must match with the Organization Id of the Merchant with which the passed Oauth Token is associated.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The virtual Terminal Id of the merchant for the 3rd Party API.</td>
</tr>
</tbody></table>

<h3 id="bill">bill</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>base_amount</td>
<td>TransactionAmount</td>
<td>The Base amount of the recurring bill. <br>The total amount charged will be the sum of this amount and (any) &lsquo;shipping_amount&rsquo; and &#39;tax_amount&rsquo;.</td>
</tr>
<tr>
<td>shipping_amount</td>
<td>TransactionAmount, optional</td>
<td>The shipping amount for the transaction. <br>The value will be included in the total amount charged.</td>
</tr>
<tr>
<td>tax_amount</td>
<td>TransactionAmount, optional</td>
<td>The tax amount for the transaction. <br>The value will be included in the total amount charged.</td>
</tr>
<tr>
<td>invoice_number</td>
<td>string, optional</td>
<td>The invoice number for the transaction.</td>
</tr>
<tr>
<td>po_number</td>
<td>string, optional</td>
<td>The purchase order number for the transaction.</td>
</tr>
<tr>
<td>note</td>
<td>string, optional</td>
<td>A free format note for the transaction. The note will be read by the merchant.</td>
</tr>
</tbody></table>

<h3 id="card_data">card_data</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>tokenized_card</td>
<td>string, optional</td>
<td>This is the 16 character PayHub-specific tokenized string that represents the card number.<br>You can obtain the value for the given customer and credit card by examining the last sale, by accessing the link to the card data that was successfully created. It is safer (and recommended) method for the third party client to store and use this string in any future requests for the same customer. <br>This value is required if the &#39;card_number&rsquo; property is not present in the request.</td>
</tr>
<tr>
<td>card_number</td>
<td>string, optional</td>
<td>This is the 16 character card number. <br>The card number is not stored by the API in plain text. The response will contain a tokenized card number that should always be used in future requests, (for the same Customer) in place of this property. <br>This value is required if the &#39;tokenized_card&rsquo; property is not present in the request.</td>
</tr>
<tr>
<td>billing_address_1</td>
<td>string, optional</td>
<td>The billing street address of the customer.</td>
</tr>
<tr>
<td>billing_address_2</td>
<td>string, optional</td>
<td>The additional billing street address of the customer.</td>
</tr>
<tr>
<td>billing_city</td>
<td>string, optional</td>
<td>The billing city of the customer.</td>
</tr>
<tr>
<td>billing_state</td>
<td>string, optional</td>
<td>The billing (US) State Code (CA, WI, NY, etc.) of the customer.</td>
</tr>
<tr>
<td>billing_zip</td>
<td>string, optional</td>
<td>The billing (US) Zip Code of the customer. <br> The zip code must be either 5 digits or 5 plus four separated by a dash (&rsquo;-&rsquo;).<br> This value is required if the Merchant has turned on the AVS flag.</td>
</tr>
<tr>
<td>card_expiry_date</td>
<td>string</td>
<td>The card expiry date in the <em>YYYYMM</em> format.</td>
</tr>
<tr>
<td>cvv_data</td>
<td>string</td>
<td>A three or four digit CVV code on the card.</td>
</tr>
</tbody></table>

<h3 id="customer">customer</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>string</td>
<td>The first name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>The last name of the customer.</td>
</tr>
<tr>
<td>company_name</td>
<td>string, optional</td>
<td>The company name of the customer.</td>
</tr>
<tr>
<td>job_title</td>
<td>string, optional</td>
<td>The job title of the customer.</td>
</tr>
<tr>
<td>email_address</td>
<td>string</td>
<td>The email address of the customer. <br>The email address must be syntactically correct and valid. If email address is not specified, you must provide a phone_number to identify the customer.</td>
</tr>
<tr>
<td>web_address</td>
<td>string, optional</td>
<td>The web site address of the customer. <br>The website address, if specified, must be syntactically correct and valid.</td>
</tr>
<tr>
<td>phone_number</td>
<td>string, optional</td>
<td>The phone number of the customer. <br>The phone number must be syntactically correct. For example, (415) 234 5678, or 4152345678, or (415) 234-5678. <br>If phone number is not specified, you must provide an email_address to identify the customer.</td>
</tr>
<tr>
<td>phone_ext</td>
<td>string, optional</td>
<td>The phone extension number of the customer.</td>
</tr>
<tr>
<td>phone_type</td>
<td>string, optional</td>
<td>The type of the phone the customer is using. <br>The phone type can be [&#39;H&rsquo; or &#39;W&rsquo; or &rsquo;M&rsquo;]: H (Home), W (Work), M (Mobile).</td>
</tr>
<tr>
<td>record_format</td>
<td>string, optional</td>
<td>The value that indicates whether the sale has to be made over a credit card, debit card or cash payment. <br>The default value is &ldquo;CREDIT_CARD&rdquo;. <br>Following are the accepted values:<ul><li>CASH_PAYMENT</li><li>CREDIT_CARD</li><li>DEBIT_CARD</li></ul></td>
</tr>
</tbody></table>

<h2 id="example-of-json">Example of JSON</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10002</span><span class="p">,</span><span class="w">
     </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="s2">"shipping_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.23</span><span class="w">
      </span><span class="p">},</span><span class="w">
     </span><span class="s2">"tax_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.00</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="s2">"note"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Send as a gift."</span><span class="p">,</span><span class="w">
     </span><span class="s2">"invoice_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"328742"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"po_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2474-6975"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"card_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5466410004374507"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card_expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"202011"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2350 Kerner Blvd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2 floor"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_city"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"San Rafael"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"billing_zip"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"94901"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvv_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"998"</span><span class="w">
</span><span class="p">},</span><span class="w">

</span><span class="s2">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Miguel"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"last_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"company_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Payhub Inc"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Software Engineer"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"email_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"msmith14567@payhub.com"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"web_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://payhub.com"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"phone_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 479 1349"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"phone_ext"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="w">
</span><span class="p">},</span><span class="w">
</span><span class="s2">"record_format"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT_CARD"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="result">Result</h2>

<ul>
<li>201 code (created)</li>
<li>The Id of the AuthOnly in the Location header <br>Sample header in the response:Location: http://payhub.com/payhubws/api/v2/authOnly/234</li>
</ul>

<blockquote>
<p>You will need to use Oauth token in the header request for sales or any other transaction. For more information, see the [OAUTH]https://payhub.atlassian.net/wiki/display/MM/OAuth+2.0+Access+Tokens section.</p>
</blockquote>

          <h1 id="boarding-webhook">Boarding Webhook</h1>

<p>This topic provides the information about the web service that you need to create to receive requests from the Boarding WebHook. Using this WebHook, you can make your system aware of the PayHub login credentials whenever a merchant is boarded through a Frictionless Application.</p>

<p>Refer the information in this topic as the Request and Response format specification for the Boarding Webhook, which runs and queries the system for new merchants that have been boarded to PayHub.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">POST</code></p>

<h2 id="end-point-url">End Point URL</h2>

<p>Specified by the Sales Office in the Manage Frictionless Links section.</p>

<h2 id="request-elements-(from-safyer)">Request Elements (from Safyer)</h2>

<p>All fields are required unless indicated otherwise</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>internalID</td>
<td>string, 5 - 20 digits</td>
<td>The unique system identifier for the merchant issued by Safyer.</td>
</tr>
<tr>
<td>mid</td>
<td>string, 5 - 20 digits</td>
<td>The unique Merchant Identification Number (MID) issued by the processor.</td>
</tr>
<tr>
<td>detail</td>
<td>string, optional, (0 - 100 characters)</td>
<td>A string of data sent by the Sales Office in the query string.</td>
</tr>
<tr>
<td>payHub_OrgID</td>
<td>string, 1 - 11 numbers</td>
<td>The unique system identifier for the merchant issued by PayHub.</td>
</tr>
<tr>
<td>payHub_UserID</td>
<td>string, 8 - 20 characters</td>
<td>The username generated for the default PayHub user.</td>
</tr>
<tr>
<td>payHub_Password</td>
<td>string, 5 - 20 characters</td>
<td>The password generated for the default PayHub user.</td>
</tr>
<tr>
<td>payHub_AuthToken</td>
<td>string, optional, 0 - 100 characters</td>
<td>The OAuth Token used to authenticate the PayHub v2 API.</td>
</tr>
<tr>
<td>termID</td>
<td>string, 4 - 20 characters</td>
<td>The terminal number associated with the PayHub account.</td>
</tr>
</tbody></table>

<h2 id="response-elements-(to-safyer)">Response Elements (to Safyer)</h2>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>string, 1 digit</td>
<td>The response code returned in the response.<br><ul><li>0: ‘Success’</li><li>1: ‘Error’</li></ul></td>
</tr>
<tr>
<td>msg</td>
<td>string, 2 - 5 characters</td>
<td>If code is 0 then msg is ‘OK’. Otherwise, msg is ‘ERROR’.</td>
</tr>
</tbody></table>

<h2 id="response-example">Response Example</h2>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="nt">&lt;Response&gt;</span>
<span class="nt">&lt;code&gt;</span>0<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;msg&gt;</span>OK<span class="nt">&lt;/msg&gt;</span>
<span class="nt">&lt;/Response&gt;</span>
</code></pre>

          <h1 id="capture-transaction">Capture Transaction</h1>

<p>This topic provides information about the <strong>Capture</strong> transaction.</p>

<p>Use the Capture transaction as the final step to collect the funds that you had asked for authorization through the AuthOnly transaction. You need to provide the transaction ID that you receive when you run the <strong>AuthOnly</strong> transaction.</p>

<p>In case the order fulfilment process, such as <em>shipping goods some days after they were ordered</em>, is delayed you might want to first run the AuthOnly transaction and then capture the respective funds. You might also need to change the amount that you got an authorization for. In that case, you need to provide a new bill section, including base amount and, if required, shipping amount, tax amount, invoice number, PO number, and note.</p>

<p>If the Capture transaction executes successfully, you will receive a 201 Created code. This code will include the transaction id. This transaction ID should be the same ID that you provided, which means, the same transaction id of the AuthOnly transaction that you just captured.</p>

<p>After capturing the amount for the AuthOnly transaction, the transaction will become a sale. The money will be taken from the card holder’s account and credited to your account during the settlement of the sale.</p>

<h2 id="request-method">Request Method</h2>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">http://payhub.com/payhubws/api/v2/capture</code></p>

<h2 id="elements">Elements</h2>

<h3 id="merchant-(required)">merchant (required)</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The organization id of the merchant who did the AuthOnly that you are trying to capture.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The terminal&rsquo;s id of the merchant where the AuthOnly was done.</td>
</tr>
</tbody></table>

<h3 id="transaction_id-(integer,-required)">transaction_id (integer, required)</h3>

<p>The transaction id of the AuthOnly that you want to capture.</p>

<h3 id="bill-(optional)">bill (optional)</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>base_amount</td>
<td>TransactionAmount</td>
<td>The base amount of the recurring bill. The total amount charged will be the sum of this amount and the &lsquo;shipping_amount&rsquo;, &#39;tax_amount&rsquo; if any.</td>
</tr>
<tr>
<td>shipping_amount</td>
<td>TransactionAmount, optional</td>
<td>The shipping amount for the transaction. This amount will be included in the total amount charged.</td>
</tr>
<tr>
<td>tax_amount</td>
<td>TransactionAmount, optional</td>
<td>The tax amount for the transaction. This amount will be included in the total amount charged.</td>
</tr>
<tr>
<td>invoice_number</td>
<td>string, optional</td>
<td>The invoice number of the transaction.</td>
</tr>
<tr>
<td>po_number</td>
<td>string, optional</td>
<td>The purchase order number of the transaction.</td>
</tr>
<tr>
<td>note</td>
<td>string, optional</td>
<td>A free format note for the transaction. The note will be read by the Merchant.</td>
</tr>
</tbody></table>

<h2 id="example-of-json---code-without-new-amount">Example of JSON - Code without new amount</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
 </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">

 </span><span class="p">},</span><span class="w">

 </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"114"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="example-of-json---code-with-new-amount">Example of JSON - Code with new amount</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
     </span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
         </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">

     </span><span class="p">},</span><span class="w">

     </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"365"</span><span class="p">,</span><span class="w">

     </span><span class="s2">"bill"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

         </span><span class="s2">"base_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">6.00</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"shipping_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"tax_amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"amount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"note"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Nice guest, giving him 20% discount."</span><span class="p">,</span><span class="w">
         </span><span class="s2">"invoice_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"789468"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"po_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"789468-CAP"</span><span class="w">
     </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="result">Result</h2>

<ul>
<li>201 code (created)</li>
<li>The Id of the Capture in the Location header. This ID should be the same that you provided. <br>Sample header in the response:Location: http://payhub.com/payhubws/api/v2/authOnly/234</li>
</ul>

          <h1 id="merchant-method">Merchant Method</h1>

<p>This topic provides you the information about Merchant method that you can use to board a merchant to Safyer using the Safyer Web Service.</p>

<h4 id="request-method">Request Method</h4>

<p><code class="prettyprint">POST</code></p>

<p>Using this method, you can board a merchant associated with a previously generated Frictionless Link. The frictionless link will be generated by the Office and linked to a sales representative and pricing structure using the Safyer UI.</p>

<h4 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/merchant</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>quickId</td>
<td>string (1 - 50 characters)</td>
<td>Associates an application with pricing and a sales rep.<br>Obtained when setting up a frictionless link using the Safyer UI</td>
</tr>
<tr>
<td>legalFirstName</td>
<td>string (1 - 30 characters)</td>
<td>The given first name of the merchant.</td>
</tr>
<tr>
<td>legalLastName</td>
<td>string (1 - 30 characters)</td>
<td>The given last name of the merchant.</td>
</tr>
<tr>
<td>email</td>
<td>string (7 - 50 characters)</td>
<td>The email address of the merchant.</td>
</tr>
<tr>
<td>phone</td>
<td>numeric (10 digits)</td>
<td>The phone number of the merchant.</td>
</tr>
<tr>
<td>businessName</td>
<td>string (1 - 25 characters)</td>
<td>The legal business name of the merchant.</td>
</tr>
<tr>
<td>dbaName</td>
<td>string (1 - 25 characters)</td>
<td>The name the merchant is Doing Business As (DBA).</td>
</tr>
<tr>
<td>website</td>
<td>string, optional (1 - 40 characters)</td>
<td>The website address of the merchant.</td>
</tr>
<tr>
<td>taxID</td>
<td>numeric, optional (10 digits)</td>
<td>The Tax Identification Number of the merchant.</td>
</tr>
<tr>
<td>npo</td>
<td>bit (1 digit)</td>
<td>Indicates whether the Tax ID provided belongs to a Non-Profit Organization. Only value 0 or 1.</td>
</tr>
<tr>
<td>businessType</td>
<td>numeric (1 - 2 digits)</td>
<td>The type of business. See Business Types.</td>
</tr>
<tr>
<td>businessCategory</td>
<td>numeric (4 digits)</td>
<td>The business category. See Business Categories.</td>
</tr>
<tr>
<td>otherBusinessDesc</td>
<td>string (1 - 50 characters)</td>
<td>If the businessCategory is 0000, you must specify the name of the business category.</td>
</tr>
<tr>
<td>estimatedRevenue</td>
<td>numeric (1 - 11 digits)</td>
<td>The estimated monthly credit card sales of the merchant. The sale must be greater or equal to 0.</td>
</tr>
<tr>
<td>bankRouting</td>
<td>numeric (9 digits)</td>
<td>The routing number of the bank account of the merchant. The number must match with an existing bank routing number.</td>
</tr>
<tr>
<td>bankDDA</td>
<td>numeric (1 - 30 digits)</td>
<td>The bank account number of the merchant.</td>
</tr>
<tr>
<td>dbaAddress1</td>
<td>numeric (1 - 50 digits)</td>
<td>The merchant&rsquo;s DBA street address.</td>
</tr>
<tr>
<td>dbaAddress2</td>
<td>numeric (1 - 50 digits)</td>
<td>The merchant&rsquo;s DBA suite or apartment number.</td>
</tr>
<tr>
<td>dbazip</td>
<td>numeric (5 digits)</td>
<td>The merchant&rsquo;s DBA zip code. <br>The zip code will be used to determine the City and State of the merchant. The Address and Zip will be validated against the USPS list of valid addresses.</td>
</tr>
<tr>
<td>address1</td>
<td>string (1 - 50 digits)</td>
<td>The street address of the merchant.</td>
</tr>
<tr>
<td>address2</td>
<td>string, optional (1 - 50 digits)</td>
<td>The suite or apartment number of the merchant.</td>
</tr>
<tr>
<td>Zip</td>
<td>numeric (5 digits)</td>
<td>The zip code will be used to determine the city and state of the merchant. The address and zip will be validated against the USPS list of valid addresses.</td>
</tr>
<tr>
<td>dob</td>
<td>date (mm-dd-yyyy)</td>
<td>The data of birth of the merchant. The merchant must be above 18 years old.</td>
</tr>
<tr>
<td>ssn</td>
<td>string (1 - 50 digits)</td>
<td>The Social Security Number of the merchant.</td>
</tr>
<tr>
<td>ip</td>
<td>Alphanumeric YYY.XXX.XXX.XXX</td>
<td>The IP address of the system from where the merchant is submitting the application. <ul><li>YYY: Number between 1 - 223</li><li>XXX: Number between 0 - 255</li></ul></td>
</tr>
</tbody></table>

<h4 id="examle-json">Examle JSON</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"merchantInformation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"quickID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"W3Rg6CjtyIfasvdT/bCYRL6Opyg=="</span><span class="p">,</span><span class="w">
        </span><span class="s2">"legalFirstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"legalLastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@email.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0123456789"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"businessName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dbaName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test DBA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"website"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.test.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"taxID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"npo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"businessType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"businessCategory"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3357"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"otherBusinessDesc"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"estimatedRevenue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8000.00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bankRouting"</span><span class="p">:</span><span class="w"> </span><span class="s2">"034560015"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bankDDA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test av 2230"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dbaAddress1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test av 1010"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dbaAddress2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dbaZip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12233"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dob"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07-09-1985"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ssn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"181.23.198.26"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="business-categories">Business Categories</h2>

<table><thead>
<tr>
<th style="text-align: center">BUSINESS TYPE</th>
<th style="text-align: center">BUSINESS CATEGORY</th>
<th>DESCRIPTION</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">All</td>
<td style="text-align: center">0000</td>
<td>OTHER (indicate name &ldquo;otherBusinessDesc&rdquo; in JSON)</td>
</tr>
<tr>
<td style="text-align: center">1</td>
<td style="text-align: center">3357</td>
<td>HERTZ CORPORATION</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3366</td>
<td>BUDGET RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3387</td>
<td>ALAMO RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3388</td>
<td>AUTO EUROPE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3389</td>
<td>AVIS RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3390</td>
<td>DOLLAR RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3393</td>
<td>NATIONAL CAR RENTAL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3395</td>
<td>THRIFTY RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3398</td>
<td>ECONO-CAR RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3405</td>
<td>ENTERPRISE RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3409</td>
<td>GENERAL RENT-A-CAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7512</td>
<td>AUTO RENTALS &amp; LEASING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7513</td>
<td>TRUCK AND UTILITY TRAILER RENTALS</td>
</tr>
<tr>
<td style="text-align: center">2</td>
<td style="text-align: center">3670</td>
<td>ARCADE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7841</td>
<td>VIDEO TAPE RENTAL STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7929</td>
<td>BANDS, ORCHESTRAS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7932</td>
<td>BILLARD AND POOL ESTABLISHMENTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7933</td>
<td>BOWLING ALLEYS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7991</td>
<td>TOURIST ATTRACTIONS &amp; EXHIBITS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7993</td>
<td>VIDEO AMUSEMENT GAME SUPPLIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7994</td>
<td>VIDEO GAME ARCADES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7996</td>
<td>AMUSEMENT PARKS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7998</td>
<td>AQUARIUMS, SEAQUARIUMS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7999</td>
<td>AMUSEMENT &amp; RECREATION SERVICES</td>
</tr>
<tr>
<td style="text-align: center">3</td>
<td style="text-align: center">5021</td>
<td>COMMERCIAL FURNITURE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5712</td>
<td>FURNITURE,HOME FURNISHINGS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5719</td>
<td>MISCELLANEOUS HOME FURNISHING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5932</td>
<td>ANTIQUE SHOPS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5937</td>
<td>ANTIQUE REPRODUCTIONS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5971</td>
<td>ART DEALERS &amp; GALLERIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7641</td>
<td>REUPHOLSTERY &amp; FURNITURE REPAIR</td>
</tr>
<tr>
<td style="text-align: center">4</td>
<td style="text-align: center">5462</td>
<td>BAKERIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5811</td>
<td>CATERERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5812</td>
<td>EATING PLACES, RESTAURANTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5813</td>
<td>DRINKING PLACES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5814</td>
<td>QUICK RESTAURANT</td>
</tr>
<tr>
<td style="text-align: center">5</td>
<td style="text-align: center">5013</td>
<td>MOTOR VEHICLE SUPPPLIES &amp; NEW PARTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5172</td>
<td>PETROLEUM&amp;PETROLEUM PRODUCTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5521</td>
<td>USED-AUTOMOBILE AND TRUCK DEALERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5532</td>
<td>AUTOMOTIVE TIRE STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5533</td>
<td>AUTOMOTIVE PARTS,ACCESSORIES STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5541</td>
<td>SERVICE STATIONS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5571</td>
<td>MOTORCYCLE DEALERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7531</td>
<td>AUTOMOTIVE TOP AND BODY REPAIR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7535</td>
<td>PAINT SHOPS-AUTOMOTIVE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7538</td>
<td>AUTOMOTIVE REPAIR SHOPS-NON-DEALER</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7542</td>
<td>CAR WASHES</td>
</tr>
<tr>
<td style="text-align: center">7</td>
<td style="text-align: center">8211</td>
<td>ELEMENTARY &amp; SECONDARY SCHOOLS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8220</td>
<td>COLLEGES, UNIVERSITIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8249</td>
<td>VOCATIONAL &amp; TRADE SCHOOLS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8299</td>
<td>SCHOOLS &amp; EDUCATIONAL SVCS</td>
</tr>
<tr>
<td style="text-align: center">8</td>
<td style="text-align: center">0752</td>
<td>ANIMAL SPECIALTY SERVICE EXCEPT VET</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">0780</td>
<td>LANDSCAPING, HORTICULTURAL SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">0782</td>
<td>LAWN AND GARDEN SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1520</td>
<td>GENERAL CONTRACTORS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1711</td>
<td>PLUMBING HEATING AND AIR CONDITIONING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1731</td>
<td>ELECTRICAL CONTRACTORS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1750</td>
<td>CARPENTRY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1761</td>
<td>ROOFING &amp; SIDING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">1799</td>
<td>SPECIAL TRADE CONTRACTORS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">4121</td>
<td>TAXICABS/LIMOUSINES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">4215</td>
<td>COURIER SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">4812</td>
<td>TELEPHONE SERVICE/EQUIPMENT-NON-UTIL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">4816</td>
<td>INFORMATION SERVICES-via COMPUTER NE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5045</td>
<td>COMPUTERS,PERIPHERAL EQUIP,SFTWRE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5065</td>
<td>ELECTRICAL PARTS AND EQUIPMENT</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5713</td>
<td>FLOOR COVERING STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5734</td>
<td>COMPUTER SOFTWARE SHOPS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5968</td>
<td>CONTINUITY/SUBSCRIPTION MERCH.</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">6300</td>
<td>INSURANCE SALES AND UNDERWRITING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">6513</td>
<td>Property Rental Services</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7210</td>
<td>LAUNDRY, CLEANING, &amp; GARMENT SERVICE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7217</td>
<td>CARPET AND UPHOLSTERY CLEANING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7261</td>
<td>FUNERAL SERVICE &amp; CREMATORIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7276</td>
<td>TAX PREPARATION SERVICE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7277</td>
<td>COUNSELING SERVICE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7299</td>
<td>MISCELLANEOUS PERSONAL SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7311</td>
<td>ADVERTISING SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7333</td>
<td>COMMERCIAL PHOTOGRAPHY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7349</td>
<td>CLEANING &amp; MAINTENANCE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7372</td>
<td>COMPUTER AND DATA PROCESSING SERVICE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7379</td>
<td>COMPUTER MAINT,REPAIR,SRVS NOT CLASS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7392</td>
<td>MANAGEMENT, CONSULTING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7394</td>
<td>EQUIPMENT RENTAL &amp; LEASING SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7399</td>
<td>BUSINESS SERVICES, NOT ELSEWHERE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7623</td>
<td>AIR CONDITIONING &amp; REFRIGERATION REP</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7629</td>
<td>ELECTRICAL &amp; SMALL APPLIANCE REPAIR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7911</td>
<td>DANCE STUDIOS, SCHOOLS AND HALLS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7991</td>
<td>PHYSICAL FITNESS FACILITIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7997</td>
<td>MEMBERSHIP SPORTS AND REC CLUBS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8111</td>
<td>LEGAL SERVICES, ATTORNEYS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8398</td>
<td>CHARITABLE &amp; SOCIAL SERVICE ORGANIZA</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8651</td>
<td>POLITICAL ORGANIZATIONS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8699</td>
<td>MEMBERSHIP ORGANIZATIONS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8931</td>
<td>ACCOUNTANTS, AUDITORS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8999</td>
<td>PROFESSIONAL SEVICES, NOT ELSEWHERE</td>
</tr>
<tr>
<td style="text-align: center">9</td>
<td style="text-align: center">5311</td>
<td>DEPARTMENT STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5611</td>
<td>MEN&rsquo;S &amp; BOYS&#39;CLOTHING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5621</td>
<td>WOMEN&rsquo;S READY-TO-WEAR STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5631</td>
<td>WOMEN&rsquo;S ACCESSORY &amp; SPECIALTY SHOPS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5641</td>
<td>CHILDREN&rsquo;S AND INFANTS&rsquo; WEAR</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5651</td>
<td>FAMILY CLOTHING STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5661</td>
<td>SHOE STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5691</td>
<td>MEN&rsquo;S WOMEN&rsquo;S CLOTHING STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5699</td>
<td>MISCELLANEOUS APPAREL &amp; ACCESSORY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7296</td>
<td>CLOTHING-RENTAL, COSTUMES</td>
</tr>
<tr>
<td style="text-align: center">10</td>
<td style="text-align: center">0742</td>
<td>VETERINARY SERVICES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5047</td>
<td>MED/DENTAL/OPHTHALMIC HOSP EQ&amp;SU</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8011</td>
<td>OFFICES AND CLINICS OF DOCTORS OF MEDICINE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8021</td>
<td>DENTISTS, ORTHODONTISTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8031</td>
<td>OSTEOPATHS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8041</td>
<td>CHIROPRACTORS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8042</td>
<td>OPTOMETRISTS, OPHTHALMOLOGISTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8043</td>
<td>OPTICIANS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8049</td>
<td>CHIROPODISTS, PODIATRISTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8062</td>
<td>HOSPITALS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8071</td>
<td>MEDICAL &amp; DENTAL LABORATORIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">8099</td>
<td>MEDICAL SERVICES &amp; HEALTH PRACTITION</td>
</tr>
<tr>
<td style="text-align: center">11</td>
<td style="text-align: center">2741</td>
<td>MISCELLANEOUS PUBLISHING &amp; PRINTING</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5094</td>
<td>PRECIOUS STONES,METALS,WATCHES,JEWEL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5192</td>
<td>BOOKS,PERIODICALS,&amp;NEWSPAPERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5193</td>
<td>FLORIST SUPPLIES,NURSERY STK,FLOWERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5251</td>
<td>HARDWARE STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5331</td>
<td>VARIETY STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5399</td>
<td>MISCELLANEOUS GENERAL MERCHANDISE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5411</td>
<td>GROCERY STORES,SUPERMARKETS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5499</td>
<td>MISCELLANEOUS FOOD STORES-SPECIALTY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5655</td>
<td>SPORTS APPAREL, RIDING APPAREL STORE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5732</td>
<td>RADIO,TELEVISION, &amp; STERO</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5733</td>
<td>MUSIC STORES, MUSICAL INSTRUMENTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5912</td>
<td>DRUG STORES &amp; PHARMACIES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5921</td>
<td>LIQUOR STORE</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5941</td>
<td>SPORTING GOODS STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5944</td>
<td>JEWELRY STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5946</td>
<td>CAMERA &amp; PHOTOGRAPHIC SUPPLY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5947</td>
<td>GIFT, CARD, NOVELTY</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5977</td>
<td>COSMETIC STORES</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5993</td>
<td>CIGAR STORES AND STANDS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5995</td>
<td>PET SHOPS, PET FOODS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5999</td>
<td>MISCELLANEOUS AND SPECIALTY RETAIL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7032</td>
<td>SPORTING &amp; RECREATIONAL CAMPS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7216</td>
<td>DRY CLEANERS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7221</td>
<td>PHOTOGRAPHIC STUDIOS-PORTRAITS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7230</td>
<td>BEAUTY SHOPS, BARBER SHOPS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7298</td>
<td>HEALTH &amp; BEAUTH SPAS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7699</td>
<td>MISCELLANEOUS REPAIR SHOPS</td>
</tr>
<tr>
<td style="text-align: center">12</td>
<td style="text-align: center">3501</td>
<td>HOLIDAY INNS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3502</td>
<td>BEST WESTERN</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3503</td>
<td>SHERATON</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3504</td>
<td>HILTON HOTELS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3509</td>
<td>MARRIOTT</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3510</td>
<td>DAYS INNS OF AMERICA</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3513</td>
<td>WESTIN HOTELS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3535</td>
<td>HILTON INTERNATIONAL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3562</td>
<td>COMFORT INN</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3665</td>
<td>HAMPTON INN</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3687</td>
<td>CLARION HOTEL</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3690</td>
<td>COURTYARD BY MARRIOTT</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">3700</td>
<td>MOTEL 6</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">5992</td>
<td>FLORISTS</td>
</tr>
<tr>
<td style="text-align: center"></td>
<td style="text-align: center">7011</td>
<td>HOTELS, MOTELS, &amp; RESORTS</td>
</tr>
<tr>
<td style="text-align: center">13</td>
<td style="text-align: center">4511</td>
<td>AIRLINES</td>
</tr>
</tbody></table>

<h2 id="business-types">Business Types</h2>

<table><thead>
<tr>
<th>Business Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>Auto Rental</td>
</tr>
<tr>
<td>2</td>
<td>Entertainment</td>
</tr>
<tr>
<td>3</td>
<td>Furniture</td>
</tr>
<tr>
<td>4</td>
<td>Restaurants</td>
</tr>
<tr>
<td>5</td>
<td>Automotive</td>
</tr>
<tr>
<td>7</td>
<td>schools</td>
</tr>
<tr>
<td>8</td>
<td>Services</td>
</tr>
<tr>
<td>9</td>
<td>Clothing</td>
</tr>
<tr>
<td>10</td>
<td>Medical</td>
</tr>
<tr>
<td>11</td>
<td>Miscellaneous</td>
</tr>
<tr>
<td>12</td>
<td>Lodging</td>
</tr>
<tr>
<td>13</td>
<td>Travel</td>
</tr>
</tbody></table>

<h2 id="enhanced-merchant-validation">Enhanced Merchant Validation</h2>

<p>When posting a merchant, we confirm that the following fields contain real data:
* Routing Number
* Phone Number
* Email
* Address</p>

<p>As these fields go beyond basic validation, it is recommended that you handle the responses from Safyer in a user friendly way. If you would like to test the validation on these fields, you can use the following test values to return an error response that has matched basic validation, but has been identified as dummy data.
<code class="prettyprint">
&quot;phone&quot;: &quot;1232342456&quot;
&quot;address1&quot;: &quot;1 testing st&quot;, &quot;address2&quot;: &quot;&quot;, &quot;zip&quot;: &quot;12345&quot;
&quot;bankRouting&quot;: &quot;123123123&quot;
&quot;email&quot;: &quot;john.doe@rlyfakenmehere.com&quot;
</code></p>

          <h1 id="recurring-bill-status">Recurring Bill Status</h1>

<p>This topic provides the information about the Recurring Bill Status API. Use the Recurring Billing Status API to change the status of any recurring bill.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">PATCH</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">http://payhub.com/payhubws/api/recurring-bill-status/{id}</code></p>

<h2 id="elements">Elements</h2>

<h3 id="recurringbillstatusinput">RecurringBillStatusInput</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>recurring_bill_status</td>
<td>string</td>
<td>The status of the recurring bill: [&lsquo;ACTIVE&rsquo; or &#39;PAUSED&rsquo; or &#39;COMPLETED&rsquo; or &#39;CANCELED&rsquo; or &#39;DELINQUENT&rsquo; or &#39;UNKNOWN&rsquo;]. <br>The possible values to change to are:<ul><li><strong>ACTIVE</strong>: The recurring bill will be charged on the next bill date. You can change it to ACTIVE only if it is currently PAUSED.</li><li><strong>PAUSED</strong>: The recurring bill will NOT be charged while in this state. You can change it to PAUSED only if it is currently ACTIVE. Once the bill is in PAUSE state, any bill dates that pass while a bill is paused will NOT be charged. It will be charged only when it is &#39;unpaused&rsquo; or changed it back to ACTIVE state.</li><li><strong>CANCELLED</strong>: The recurring bill will be stopped. It will not be charged again. You can change to CANCELLED only if it is currently ACTIVE or PAUSED. Once the bill is cancelled, you cannot change its status.</li></ul> <strong>Note:</strong> You cannot use the COMPLETED status to stop a recurring bill from charging in the future. You should use CANCELLED to stop a recurring bill.</td>
</tr>
</tbody></table>

<h2 id="example-of-json">Example of JSON</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
 </span><span class="s2">"recurring_bill_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CANCELED"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="response-messages">Response Messages</h2>

<table><thead>
<tr>
<th>Code</th>
<th>Meaning</th>
<th>Sample code</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>(not returned)</td>
<td><code class="prettyprint">ResourceSupport { links (array[Link], optional) } Link { templated (boolean, optional), rel (string, optional), href (string, optional) }</code></td>
</tr>
<tr>
<td>204</td>
<td>The recurring bill status was successfully updated.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>400</td>
<td>Bad request due to incorrect or invalid data passed.</td>
<td><code class="prettyprint">RestErrorStructure { errors ( array[RestError], optional)} RestError {   status ( string, optional) = [&#39;100&#39; or &#39;101&#39; or &#39;102&#39; or &#39;103&#39; or &#39;200&#39; or &#39;201&#39; or &#39;202&#39; or &#39;203&#39; or &#39;204&#39; or &#39;205&#39; or &#39;206&#39; or &#39;207&#39; or &#39;208&#39; or &#39;226&#39; or &#39;300&#39; or &#39;301&#39; or &#39;302&#39; or &#39;302&#39; or &#39;303&#39; or &#39;304&#39; or &#39;305&#39; or &#39;307&#39; or &#39;308&#39; or &#39;400&#39; or &#39;401&#39; or &#39;402&#39; or &#39;403&#39; or &#39;404&#39; or &#39;405&#39; or &#39;406&#39; or &#39;407&#39; or &#39;408&#39; or &#39;409&#39; or &#39;410&#39; or &#39;411&#39; or &#39;412&#39; or &#39;413&#39; or &#39;414&#39; or &#39;415&#39; or &#39;416&#39; or &#39;417&#39; or &#39;418&#39; or &#39;419&#39; or &#39;420&#39; or &#39;421&#39; or &#39;422&#39; or &#39;423&#39; or &#39;424&#39; or &#39;426&#39; or &#39;428&#39; or &#39;429&#39; or &#39;431&#39; or &#39;500&#39; or &#39;501&#39; or &#39;502&#39; or &#39;503&#39; or &#39;504&#39; or &#39;505&#39; or &#39;506&#39; or &#39;507&#39; or &#39;508&#39; or &#39;509&#39; or &#39;510&#39; or &#39;511&#39;]: The Http Status Code, code ( string, optional), location ( string, optional), reason ( string, optional), severity ( string, optional) }</code></td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized. You do not have permission to perform this operation. Make sure you entered a valid API Key at the top of the page.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>403</td>
<td>Forbidden. The server does not permit you to use this URI.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
<tr>
<td>500</td>
<td>Internal server error due to encoding the data, or to a PayHub server failure. Contact PayHub.</td>
<td><code class="prettyprint">Void {}</code></td>
</tr>
</tbody></table>

          <h2 id="refund-transaction">Refund Transaction</h2>
<pre><code class="highlight java"><span class="kn">package</span> <span class="n">transactions</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.http.Header</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.ClientProtocolException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.HttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpPost</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.entity.StringEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.DefaultHttpClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpConnectionParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.params.HttpParams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Refund</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">RunRefund</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">HttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHttpClient</span><span class="o">();</span>
      <span class="n">HttpParams</span> <span class="n">params</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getParams</span><span class="o">();</span>
      <span class="n">HttpConnectionParams</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

      <span class="n">JSONObject</span> <span class="n">jsonRequestObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://payhub.com/payhubws/api/v2/refund"</span><span class="o">;</span>

      <span class="n">JSONObject</span> <span class="n">merchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"organization_id"</span><span class="o">,</span> <span class="s">"10005"</span><span class="o">);</span><span class="c1">//You put your org id here</span>
      <span class="n">merchant</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"terminal_id"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">);</span><span class="c1">//You put your terminal id</span>

      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"merchant"</span><span class="o">,</span> <span class="n">merchant</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"record_format"</span><span class="o">,</span> <span class="s">"CREDIT_CARD"</span><span class="o">);</span>
      <span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"transaction_id"</span><span class="o">,</span> <span class="s">"226"</span><span class="o">);</span>

      <span class="n">HttpPost</span> <span class="n">postCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="o">);</span><span class="c1">//You put your token here</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">addHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

      <span class="n">StringEntity</span> <span class="n">se</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">jsonRequestObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">postCreate</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">se</span><span class="o">);</span>
      <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">postCreate</span><span class="o">);</span><span class="c1">//You return this response and work with it</span>

      <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">" "</span><span class="o">;</span>
      <span class="n">JSONObject</span> <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getEntity</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
      <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">while</span> <span class="o">((</span><span class="n">cnt</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">json</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">cnt</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'&lt;'</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">jsonResponseObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span>
            <span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">json</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="s">" "</span><span class="o">)</span> <span class="o">?</span> <span class="s">"{\"MESSAGE\":\"NO RESPONSE...\"}"</span>
                <span class="o">:</span> <span class="n">json</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusLine</span><span class="o">().</span><span class="na">getReasonPhrase</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Created"</span><span class="o">)){</span>
        <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Header</span> <span class="n">header</span> <span class="o">:</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"Location"</span><span class="o">)){</span>
            <span class="n">URL</span> <span class="n">location</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">header</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">transactionId</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">lastSlash</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Transaction Id: "</span> <span class="o">+</span> <span class="n">transactionId</span> <span class="o">);</span>
          <span class="o">}</span>

        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonResponseObject</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
      <span class="o">}</span>


    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span>
</code></pre>
<pre><code class="highlight php"><span class="cp">&lt;?php</span>
  <span class="nv">$trans_type</span> <span class="o">=</span> <span class="s2">"refund"</span><span class="p">;</span>
  <span class="nv">$processed</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="nv">$ERROR_MESSAGE</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

  <span class="c1">//Defining the Web Service URL
</span>  <span class="nv">$WsURL</span><span class="o">=</span><span class="s2">"http://payhub.com/payhubws/api/v2/</span><span class="nv">$trans_type</span><span class="s2">"</span><span class="p">;</span>


  <span class="c1">//Defining data for the REFUND transaction
</span>  <span class="c1">// Merchant data (obtained from the payHub Virtual Terminal (3rd party integration)
</span>  <span class="nv">$organization_id</span> <span class="o">=</span> <span class="mi">10002</span><span class="p">;</span>
  <span class="nv">$terminal_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nv">$oauth_token</span> <span class="o">=</span> <span class="s2">"22fe3c69-db70-4a8c-9aed-9a33ebb1e9b4"</span><span class="p">;</span>

  <span class="c1">//The rest of the data needed
</span>  <span class="nv">$record_format</span><span class="o">=</span><span class="s2">"CREDIT_CARD"</span><span class="p">;</span>
  <span class="nv">$transaction_id</span><span class="o">=</span><span class="s2">"82"</span><span class="p">;</span>



  <span class="c1">//Convert data to array to send it to the WS as JSON format
</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"merchant"</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"organization_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$organization_id</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"terminal_id"</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="nv">$terminal_id</span><span class="s2">"</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"record_format"</span><span class="p">]</span><span class="o">=</span><span class="nv">$record_format</span><span class="p">;</span>
  <span class="nv">$data</span><span class="p">[</span><span class="s2">"transaction_id"</span><span class="p">]</span><span class="o">=</span><span class="nv">$transaction_id</span><span class="p">;</span>

  <span class="c1">//Convert data from Array to JSON
</span>  <span class="nv">$data_string</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

  <span class="c1">//Creating a CURL object to access the WS
</span>  <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
  <span class="c1">//Setting the address to connect to
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$WsURL</span><span class="p">);</span>
  <span class="c1">//Setting HTTP method. For a new transaction we need to use POST
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>
  <span class="c1">//Setting data in JSON format
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data_string</span><span class="p">);</span>
  <span class="c1">//Setting the proper header.
</span>  <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
    <span class="s1">'Accept: application/json'</span><span class="p">,</span>
    <span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="c1">//Set to return the response header, this is to analyze the result and the transaction ID
</span>  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

  <span class="c1">//execute connection to the Web Service
</span>  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
  <span class="c1">// get some data from the response
</span>  <span class="nv">$httpcode</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
  <span class="nv">$header_size</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HEADER_SIZE</span><span class="p">);</span>
  <span class="c1">//Get the header as string.
</span>  <span class="nv">$header</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$header_size</span><span class="p">);</span>
  <span class="c1">//close connection to the Web Service
</span>  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

  <span class="c1">//Obtain the data from the refund recently created
</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$httpcode</span><span class="o">==</span><span class="mi">201</span><span class="p">){</span>
    <span class="c1">//find the url of the refund (Location header in the response)
</span>    <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"!</span><span class="se">\r\n</span><span class="s2">(?:Location): *(.*?) *</span><span class="se">\r\n</span><span class="s2">!"</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
    <span class="c1">//$url contains the URL to GET the data from the Web Service
</span>    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//Once we get the transaction ID we will query for the information of the last transaction
</span>    <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="c1">//Setting HTTP method. To get a transaction response we need to use GET
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"GET"</span><span class="p">);</span>
    <span class="c1">//Setting the proper header.
</span>    <span class="c1">//Setting the oauth_token to access the WS with the proper authorization
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Authorization: Bearer '</span><span class="o">.</span><span class="nv">$oauth_token</span><span class="p">));</span>
    <span class="c1">//Store the response as a variable and not showing the content as echo $variable
</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">//execute connection to the Web Service
</span>    <span class="nv">$response_json</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//close connection to the Web Service
</span>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="c1">//show result (standard JSON), parse it, process it, etc..
</span>    <span class="k">echo</span> <span class="nv">$response_json</span><span class="p">;</span>
    <span class="c1">// now you could parse the json object to array if you preffer: $obj = json_decode($response_json);
</span>    <span class="nv">$array</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response_json</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//There was an error with the WS
</span>  <span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Error creating the "</span><span class="o">.</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$trans_type</span><span class="p">)</span><span class="o">.</span><span class="s2">": RESPONSE MESSAGE"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
  <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>
<pre><code class="highlight csharp"><span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">PayHubSamples</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Refund</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunRefund</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://payhub.com/payhubws/api/v2/refund"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

                <span class="n">var</span> <span class="n">refund</span> <span class="p">=</span> <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">merchant</span> <span class="p">=</span> <span class="k">new</span>
                     <span class="p">{</span>
                         <span class="n">organization_id</span> <span class="p">=</span> <span class="s">"10005"</span><span class="p">,</span>
                         <span class="n">terminal_id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span>
                     <span class="p">},</span>
                    <span class="n">record_format</span> <span class="p">=</span> <span class="s">"CREDIT_CARD"</span><span class="p">,</span>
                    <span class="n">transaction_id</span> <span class="p">=</span> <span class="s">"228"</span>
                   <span class="p">};</span>

                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">refund</span><span class="p">);</span>

                <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Bearer dfd4f12a-79af-4825-8dba-db27342c8491"</span><span class="p">);</span>
                <span class="n">request</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>
                <span class="n">request</span><span class="p">.</span><span class="n">Accept</span> <span class="p">=</span> <span class="s">"application/json"</span><span class="p">;</span>

                <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
                <span class="p">{</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                    <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">request</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span><span class="c1">//You return this response.
</span>                    <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                    <span class="p">{</span>
                        <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span><span class="c1">//Created
</span>                        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="s">"Location"</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                                <span class="kt">int</span> <span class="n">lastSlash</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">LastIndexOf</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
                                <span class="kt">string</span> <span class="n">transactionId</span> <span class="p">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">lastSlash</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Transaction Id: "</span> <span class="p">+</span> <span class="n">transactionId</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">wex</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">errorResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">wex</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span><span class="c1">//You return wex.Response instead
</span>                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
                            <span class="p">{</span>
                                <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"organization_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
    </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"record_format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT_CARD"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"114"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h1 id="refund-transaction">Refund Transaction</h1>

<p>This topic provides the information the Refund transaction.</p>

<p>Run the Refund transaction when you want to refund the full amount of a settled sale, which is not yet refunded. The refund amount will be the same as the total amount that was originally charged in the sale. The amount is refunded to the credit or debit card that was originally charged.</p>

<h2 id="request-method">Request Method</h2>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">http://payhub.com/payhubws/api/refund</code></p>

<h2 id="elements">Elements</h2>

<p>(All Required)</p>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The organization id of the merchant who did the sale that you are trying to refund.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The terminal id of the merchant from where the sale is done.</td>
</tr>
<tr>
<td>record_format</td>
<td>string</td>
<td>To specify if the sale has to be made over a credit card, debit card or cash payment. <br>The accepted values are: <ul><li>CASH_PAYMENT</li><li>CREDIT_CARD</li><li>DEBIT_CARD</li></ul></td>
</tr>
<tr>
<td>transaction_id</td>
<td>integer</td>
<td>The transaction id of the sale you want to refund.</td>
</tr>
</tbody></table>

<h2 id="example-of-json">Example of JSON</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
 </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">

 </span><span class="p">},</span><span class="w">

 </span><span class="s2">"record_format"</span><span class="p">:</span><span class="s2">"CREDIT_CARD"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"114"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="reporting-methods">Reporting Methods</h1>

<h2 id="available-resources">AVAILABLE RESOURCES</h2>

<p>The Safyer Web Service provides the following resources to report on merchant activity.</p>

<table><thead>
<tr>
<th>Resource</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>batchReport</td>
<td>POST</td>
</tr>
<tr>
<td>batch</td>
<td>GET</td>
</tr>
<tr>
<td>transaction</td>
<td>GET</td>
</tr>
<tr>
<td>depositReport</td>
<td>POST</td>
</tr>
<tr>
<td>deposit</td>
<td>GET</td>
</tr>
<tr>
<td>statementReport</td>
<td>POST</td>
</tr>
<tr>
<td>chargebackReport</td>
<td>POST</td>
</tr>
</tbody></table>

<h2 id="batchreport">batchReport</h2>

<p>Retrieves information from all transactions of a Merchant for a specific date range. The date range cannot be greater than 30 days. The response will include the IdBatch element, which can be referenced using the GET batch method.</p>

<h4 id="request-method:">Request Method:</h4>

<p>POST</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/batchReport</code></p>

<h4 id="parameters">Parameters</h4>

<p>All these parameters are in a JSON:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mid</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>dateCreateFrom</td>
<td>Date, Optional</td>
<td>Format mm-dd-yyyy</td>
</tr>
<tr>
<td>dateCreateTo</td>
<td>Date, Optional</td>
<td>Format mm-dd-yyyy</td>
</tr>
</tbody></table>

<h4 id="example-json">Example JSON</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"BatchReport"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"mid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7620000000000002"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dateCreateFrom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03-23-2015"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dateCreateTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"04-13-2015"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="batch">batch</h2>

<p>Retrieves information from all transactions for a Batch ID (for a specific day and Merchant). The response will include the transactionId element which can be referenced using the GET transaction method.</p>

<h4 id="request-method:">Request Method:</h4>

<p>GET</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/batch/{{batchId}}</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>iBatch</td>
<td>Numeric</td>
<td>A number that identifies a single batch.<br><strong>Note:</strong> The idBatch element can be found using the POST batchReport method.</td>
</tr>
</tbody></table>

<h2 id="transaction">transaction</h2>

<p>Retrieves all information of a specific transaction.</p>

<h4 id="request-method:">Request Method:</h4>

<p>GET</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/transaction/{{transactionId}}</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>idTransaction</td>
<td>Numeric</td>
<td>A number that identifies a single transaction.<br><strong>Note:</strong> The idTransaction element can be found using the GET batch method.</td>
</tr>
</tbody></table>

<h2 id="depositreport">depositReport</h2>

<p>Retrieves information from all deposits of a Merchant, between a range of dates. The response will include the idDeposit element, which can be referenced using the GET deposit method.</p>

<h4 id="request-method:">Request Method:</h4>

<p>POST</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/depositReport</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mid</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>dateFrom</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
<tr>
<td>dateTo</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
</tbody></table>

<h4 id="example-json">Example JSON</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"Deposit"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"mid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7620000000000002"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dateFrom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03-23-2015"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dateTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"04-13-2015"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><strong>Notes:</strong></p>

<ul>
<li>If the date range is greater than 31 days or if you omit the dateTo element, the results returned will be 31 days from the dateFrom element.</li>
<li>If you omit the dateFrom element, the web service will assume a dateFrom of 31 days prior to the dateFrom value.</li>
<li>If you do not indicate the date range, the web service will return deposits from the current date.</li>
</ul>

<h2 id="deposit">deposit</h2>

<p>Retrieves all information of a specific deposit.</p>

<h4 id="request-method:">Request Method:</h4>

<p>GET</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/deposit/{{depositId}}</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>iDeposit</td>
<td>numeric</td>
<td>A number that identifies a single transaction.<br><strong>Note:</strong> The idDeposit element can be found using the POST depositReport method.</td>
</tr>
</tbody></table>

<h2 id="statementreport">statementReport</h2>

<p>Returns the Merchant Statement XML for a specific month and year. This XML is received from the merchant&rsquo;s processor and relayed as it is.</p>

<h4 id="request-method:">Request Method:</h4>

<p>POST</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/statementReport</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mid</td>
<td>string</td>
<td>The number of a merchant.</td>
</tr>
<tr>
<td>stmtMonth</td>
<td>numeric</td>
<td>A number between 1 and 12.</td>
</tr>
<tr>
<td>stmtYear</td>
<td>numeric</td>
<td>A number between 0000 and 9999.</td>
</tr>
</tbody></table>

<h4 id="example-json">Example JSON</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"mid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7620000000000002"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"stmtMonth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"stmtYearSt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="chargebackreport">chargebackReport</h2>

<p>Returns information, the chargebacks for the specified merchant.</p>

<h4 id="request-method:">Request Method:</h4>

<p>POST</p>

<h4 id="endpoint-(url-to-call):">Endpoint (URL to Call):</h4>

<p><code class="prettyprint">https://ws.safyer.com/api/v1/chargeback</code></p>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mid</td>
<td>string</td>
<td>The number of a merchant.</td>
</tr>
<tr>
<td>transactionDateFrom</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
<tr>
<td>transactionDateTo</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
<tr>
<td>receivedDateFrom</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
<tr>
<td>receivedDateTo</td>
<td>date, optional</td>
<td>Format mm-dd-yyyy.</td>
</tr>
<tr>
<td>cardNumlast4</td>
<td>numeric, optional</td>
<td>A number between 0000 and 9999.</td>
</tr>
<tr>
<td>authorizationCode</td>
<td>string, optional</td>
<td>A string of 6 characters.</td>
</tr>
</tbody></table>

<h4 id="example-json">Example JSON</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"Chargeback"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"mid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7620000000000002"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"transactionDateFrom"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"transactionDateTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"receivedDateFrom"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"receivedDateTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cardNumLast4"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"authorizationCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><strong>Note:</strong> The processor does not provide a unique number that can be used to tie the chargeback to the original transaction.</p>

          <h1 id="transaction-report">Transaction Report</h1>

<p>This API allows the merchant to search for transactions filtering by a wide range of optional parameters.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">PATCH</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">webservice URL/api/v2/search/transactionReport</code></p>

<h2 id="required-headers">Required Headers</h2>

<ul>
<li><strong>Content-Type</strong>: application/json</li>
<li><strong>Accept</strong>: application/json</li>
<li><strong>Authorization</strong>: Bearer {auth_token}</li>
</ul>

<h2 id="payload-(json-format)">Payload (JSON Format)</h2>
<pre><code class="highlight json"><span class="p">{</span><span class="err">“parameter1”</span><span class="p">:</span><span class="err">”value”</span><span class="p">,</span><span class="w">
</span><span class="err">“parameter2”</span><span class="p">:</span><span class="err">”value”</span><span class="p">,</span><span class="w">
</span><span class="err">“parameter3”</span><span class="p">:</span><span class="err">”value”</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="parameters">Parameters</h2>

<p>All the parameters are optional, they can be sent in no particular order. If one of the parameters is incorrect the server will return an error.</p>

<p>The parameters are case sensitive.</p>

<p>Below is an explanation of the parameters.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>batchIdFrom, batchIdTo</td>
<td>Allows the merchant to look for transactions where the <strong>batchId</strong> is between the batchIdFrom and batchIdTo. <br>You can also use any one of the two parameters. In that case, the result will be the transactions with the batchId greater than <strong>batchIdFrom</strong>, or the batchId less than <strong>batchIdTo</strong>.</td>
</tr>
<tr>
<td>transactionType</td>
<td>Allows the merchant to look for transactions where the transaction type is any one of the following:<ul><li>Void</li><li>Sale</li><li>Refund</li><li>Verify</li></ul></td>
</tr>
<tr>
<td>responseCode</td>
<td>Allows the merchant to look for transactions where the response code is equal to a specific code. For example, the code “00” means a successful transaction.</td>
</tr>
<tr>
<td>amountFrom, amountTo</td>
<td>Allows the merchant to look for transactions where the amount of the transaction is between the <strong>amountFrom</strong> and <strong>amountTo</strong>. <br>You can use any one of the two parameters. In that case, the result will be the transactions with the amount greater than <strong>amountFrom</strong>, or the amount less than <strong>amountTo</strong>.</td>
</tr>
<tr>
<td>firstName</td>
<td>Allows the merchant to look for transactions where the customer’s first name contains the value of the parameter.</td>
</tr>
<tr>
<td>lastName</td>
<td>Allows the merchant to look for transactions where the customer’s first name contains the value of the parameter.</td>
</tr>
<tr>
<td>phoneNumber</td>
<td>Allows the merchant to look for transactions where the customer’s phone number contains the value of the parameter.</td>
</tr>
<tr>
<td>email</td>
<td>This parameter allows the merchant to look for transactions where the customer’s email address contains the value of the parameter.</td>
</tr>
<tr>
<td>trnDateFrom, trnDateTo</td>
<td>Allows the merchant to look for transactions where the date of the transaction is between the trnDateFrom and trnDateTo. <br>You can use any one of the two parameters. In that case, the result will be the transactions with the date later than the trnDateFrom, or the date earlier than trnDateTo.<br>Format: “yyyy-mm-dd hh:mm:ss”.</td>
</tr>
<tr>
<td>cardType</td>
<td>This parameter allows the merchant to look for transactions where the card type matches the value of the parameter. <br>For instance: MasterCard, Visa.</td>
</tr>
<tr>
<td>cardLast4Digits</td>
<td>Allows the merchant to look for transactions where the credit card’s last four digits matches the value of the parameter. <br>Format: “XXXX”.</td>
</tr>
<tr>
<td>cardToken</td>
<td>Allows the merchant to look for transactions where the credit card’s token matches the value of the parameter. <br>Format: “XXXXXXXXXXXXXXXX”.</td>
</tr>
<tr>
<td>authAmountFrom, authAmountTo</td>
<td>Allows the merchant to look for transactions where the authorized amount of the transaction is between the authAmountFrom and authAmountTo. <br>You can use any one of the two parameters. In that case the result will be the transactions with the authorization amount is greater than <strong>authAmountFrom</strong>, or the authorization amount less than <strong>authAmountTo</strong>.</td>
</tr>
<tr>
<td>swiped</td>
<td>Allows the merchant to look for transactions that where performed with a swiper device. <br>Valid values: true, false</td>
</tr>
<tr>
<td>source</td>
<td>Allows the merchant to look for transactions where the source matches the value of the parameter. <br>For instance: “3rd Party API”</td>
</tr>
<tr>
<td>note</td>
<td>Allows the merchant to look for transactions where the note matches the value of the parameter.</td>
</tr>
<tr>
<td>transactionStatus</td>
<td>Allows the merchant to look for transactions where the transaction status matches the value of the parameter. <br>For instance: “Approved”</td>
</tr>
</tbody></table>

<h2 id="result-data">Result Data</h2>

<p>The result data is an array of objects in JSON format.</p>

<h4 id="sample-object-in-json-format">Sample Object in JSON Format</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.0"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authAmount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.0"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"batchID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1311"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cardLast4Digits"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XXXXXXXXXXXX4500"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cardToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9999000000002145"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cardType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MasterCard"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customerName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"First Contact"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first.contact@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phoneNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 122 4567"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"responseCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"responseText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VER UNAVAILABLE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3rd Party API"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"swiped"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transactionDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-04-02 11:46:57"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transactionID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"180836"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transactionStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Approved"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transactionType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sale"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="verify-transaction">Verify Transaction</h1>

<p>This topic provides the information about the using Verify transaction. Run the Verify transaction when you want to know if the card data you have is valid and ready to run other transactions, such as sale. The amount refunded is the same as the total amount that was originally charged in the sale. The amount is refunded to the credit or debit card that was originally charged.</p>

<h2 id="request-method">Request Method</h2>

<p><code class="prettyprint">POST</code></p>

<h2 id="endpoint-(url-to-call)">Endpoint (URL to Call)</h2>

<p><code class="prettyprint">http://payhub.com/payhubws/api/v2/verify</code></p>

<h2 id="elements">Elements</h2>

<h3 id="merchant">merchant</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>organization_id</td>
<td>integer</td>
<td>The Organization Id of the Merchant. This must match the Organization Id of the Merchant that the passed Oauth Token is associated with.</td>
</tr>
<tr>
<td>terminal_id</td>
<td>integer</td>
<td>The merchant&rsquo;s virtual terminal Id for 3rd Party API.</td>
</tr>
</tbody></table>

<h3 id="card_data">card_data</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tokenized_card</td>
<td>string, optional</td>
<td>This is the 16 character PayHub-specific tokenized string representing the card number. <br>The value for the given customer and credit card can be obtained by examining the last Sale by accessing the link to the card data that was successfully created. It is safer (and recommended) for the third party client to store and use this string in any future requests for the same customer. <br>This value is required if the &lsquo;card_number&rsquo; property is not present in the request.</td>
</tr>
<tr>
<td>card_number</td>
<td>string, optional</td>
<td>This is the 16 character card number. <br>This value is required if the &#39;tokenized_card&rsquo; property is not present in the request.<br><strong>Note:</strong> The card number is not stored by the API in plain text. The response will contain a tokenized card number that should always be used in future requests, (for the same Customer) in place of this property.</td>
</tr>
<tr>
<td>track1_data</td>
<td>string, optional</td>
<td>This is the string read by the swiper (It contents track 1 data without sentinels).</td>
</tr>
<tr>
<td>track2_data</td>
<td>string, optional</td>
<td>This is the string read by the swiper (It contents track 2 data without sentinels).</td>
</tr>
<tr>
<td>encrypted_track_data</td>
<td>optional</td>
<td><ul><li><strong>encrypted_track</strong> (string, optional): This is the string read by the swiper. This string contains the encrypted track data.</li><li><strong>swiper_brand</strong> (string, optional): The swiper brand&rsquo;s name with capital letters. Default value is <strong>IDTECH</strong>.</li><li><strong>swiper_model</strong> (string, optional): The swiper model with capital letters. Default value is <strong>UNIMAGII</strong>.</li></ul></td>
</tr>
<tr>
<td>billing_address_1</td>
<td>string, optional</td>
<td>The billing street address of the customer.</td>
</tr>
<tr>
<td>billing_address_2</td>
<td>string, optional</td>
<td>The additional billing street address of the customer.</td>
</tr>
<tr>
<td>billing_city</td>
<td>string, optional</td>
<td>The billing city of the customer.</td>
</tr>
<tr>
<td>billing_state</td>
<td>string, optional</td>
<td>The billing state Code of the customer. For example, CA, WI, NY, etc. <br>The sate codes should be for the states in the USA.</td>
</tr>
<tr>
<td>billing_zip</td>
<td>string, optional</td>
<td>The billing Zip Code of the customer. The zip code must be either 5 digits or 5 plus four separated by a &rsquo;-&rsquo;. <br>The zip code is required if the merchant has turned ON the AVS flag.</td>
</tr>
<tr>
<td>card_expiry_date</td>
<td>string</td>
<td>The card expiry in the YYYYMM format.</td>
</tr>
<tr>
<td>cvv_data</td>
<td>string</td>
<td>This is the three or four digit CVV code on the credit and debit card.</td>
</tr>
</tbody></table>

<h2 id="customer">customer</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>string</td>
<td>The first name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>The last name of the customer.</td>
</tr>
<tr>
<td>company_name</td>
<td>string</td>
<td>The company name of the customer.</td>
</tr>
<tr>
<td>job_title</td>
<td>string, optional</td>
<td>The job title of the customer.</td>
</tr>
<tr>
<td>email_address</td>
<td>string, optional</td>
<td>The valid email address of the customer. <br>The email address must be syntactically correct. If you do not specify the email address, you must provide a phone_number to identify the customer.</td>
</tr>
<tr>
<td>web_address</td>
<td>string, optional</td>
<td>The web address of the customer. <br>The web address, if you specify, must be syntactically valid web address.</td>
</tr>
<tr>
<td>phone_number</td>
<td>string, optional</td>
<td>The phone number of the customer. <br> The phone number must be syntactically correct. For example, (415) 234 5678, or 4152345678, or (415) 234-5678. <br>If you do not specify the phone number, you must provide an email_address to identify the customer.</td>
</tr>
<tr>
<td>phone_ext</td>
<td>string, optional</td>
<td>The phone extension number of the customer.</td>
</tr>
<tr>
<td>phone_type</td>
<td>string, optional</td>
<td>The type ([&#39;H&rsquo; or &#39;W&rsquo; or &rsquo;M&rsquo;]) phone number: H (Home), W (Work), M (Mobile).</td>
</tr>
</tbody></table>

<h4 id="sample-object-in-json-format">Sample Object in JSON Format</h4>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"merchant"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"organization_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10005</span><span class="p">,</span><span class="w">
      </span><span class="s2">"terminal_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
   </span><span class="p">},</span><span class="w">

   </span><span class="s2">"card_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"5466410004374507"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_expiry_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"202011"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"billing_address_1"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2350 Kerner Blvd"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"billing_address_2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"On the corner"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"billing_city"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"San Rafael"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"billing_state"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"billing_zip"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"94901"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cvv_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"998"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"customer"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"first_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Adam"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"company_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Go Capitalism Inc"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"job_title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Author"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"adam@smith.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"web_address"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://gocaptilaism.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 479 1349"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone_ext"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="response">Response</h2>

<ul>
<li>A 201 Created status if the card data is correct. That&rsquo;s all you need to know if card data is valid.</li>
</ul>

<p><strong>Note:</strong> You will need to use Oauth token in the header request for sales or any other transaction. For more information, see the OAUTH section.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="php">php</a>
                <a href="#" data-language-name="csharp">csharp</a>
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
